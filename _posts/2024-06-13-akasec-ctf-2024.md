---
title: Akasec CTF 2024
description: CTF-Crypto
author: Pr0pylTh10ur4C1L
date: 2024-06-13 15:57:00 +0700
categories: [Capture The Flag]
tags: [Cryptography]
pin: true
math: true
mermaid: true
---

## Lost
### Description:
Do you know the feelling of losing a part of you !!

### Attachments:
*chall.py*
```python
from random import getrandbits
from Crypto.Util.number import getPrime, bytes_to_long
from SECRET import FLAG

e = 2
p = getPrime(256)
q = getPrime(256)
n = p * q

m = bytes_to_long(FLAG)
cor_m = m - getrandbits(160)

if __name__ == "__main__":
    c = pow(m, e, n)
    print("n = {}\nc = {}\ncor_m = {}".format(n, c, cor_m))
```

*out.txt*
```
n = 5113166966960118603250666870544315753374750136060769465485822149528706374700934720443689630473991177661169179462100732951725871457633686010946951736764639
c = 329402637167950119278220170950190680807120980712143610290182242567212843996710001488280098771626903975534140478814872389359418514658167263670496584963653
cor_m = 724154397787031699242933363312913323086319394176220093419616667612889538090840511507392245976984201647543870740055095781645802588721
```

### Analysis:
ƒê√¢y l√† m·ªôt b√†i RSA v·ªõi `e` kh√° nh·ªè (e = 2). ƒê·ªÅ b√†i cho ta bi·∫øt ƒë∆∞·ª£c `n`, `c` v√† `cor_m` l√† message c·ªßa ch√∫ng ta tr·ª´ ƒëi m·ªôt s·ªë 160-bits = 20-bytes, c√≥ nghƒ©a l√† ch√∫ng ta s·∫Ω m·∫•t kho·∫£ng 20-bytes cu·ªëi c·ªßa message. Khi th·ª≠ chuy·ªÉn `cor_m` v·ªÅ d·∫°ng bytes, m√¨nh thu ƒë∆∞·ª£c nh∆∞ sau:

```python
cor_m = 724154397787031699242933363312913323086319394176220093419616667612889538090840511507392245976984201647543870740055095781645802588721

print(long_to_bytes(cor_m))
# AKASEC{c0pp3r5m17h_4774ck_1n_1ov3_v\xb1\x13q\x9f\xe3\xe4\xa1\xe2\x9b\xd5,\xfe\x14\\q\x99\xb9\x0c\xca1
```

Do ƒë√£ c√≥ m·ªôt ph·∫ßn plaintext, m√¨nh s·∫Ω s·ª≠ d·ª•ng **Steoreotyped Message** ƒë·ªÉ kh√¥i ph·ª•c l·∫°i ph·∫ßn c√≤n l·∫°i c·ªßa message v√† c√≥ ƒë∆∞·ª£c flag

### Solution:
```python
from Crypto.Util.number import *
from sage.all import *

e = 2
n = 5113166966960118603250666870544315753374750136060769465485822149528706374700934720443689630473991177661169179462100732951725871457633686010946951736764639
c = 329402637167950119278220170950190680807120980712143610290182242567212843996710001488280098771626903975534140478814872389359418514658167263670496584963653
cor_m = 724154397787031699242933363312913323086319394176220093419616667612889538090840511507392245976984201647543870740055095781645802588721

known = long_to_bytes(cor_m)[:-21]
known_int = bytes_to_long(known)

x = PolynomialRing(Zmod(n), 'x').gen()
f = (known_int * 2**(21 * 8) + x)**e - c
ans = f.small_roots(X = 2**(21 * 8), beta = 0.5)[0]
print(known.decode() + long_to_bytes(int(ans)).decode())
```

Flag: *AKASEC{c0pp3r5m17h_4774ck_1n_1ov3_w17h_5m4ll_3xp0n3nts}*

## Power Over All
### Description:
Power is given only to those who dare to lower themselves and pick it up. Only one thing matters, one thing, to be able to dare!

### Attachments:
*chal.py*
```python
from Crypto.Util.number import getPrime, bytes_to_long
from random import randint
from SECRET import FLAG

def key_gen():
    ps = []
    n = randint(2,2**6)
    for _ in range(n):
        p = getPrime(256)
        ps.append(p)
    return ps

def encrypt(m, ps):
    ps.sort()
    for p in ps:
        e = 1<<1 # 2 
        m = pow(m, e, p)
    return m

if __name__ == "__main__":
    ps = key_gen()
    c = encrypt(bytes_to_long(FLAG), ps)
    print('ps = {}\nc = {}'.format(ps, c))
```

*out.txt*
```
ps = [58320376514263631335873677765253125888698486914776244278840394907785982174227, 58471100903556849464997941473361218814224259836954194397969653104598610032001, 58604272362819290182402155417145974680722885151257754555756391392263925028373, 59492683945798085501800206338526899942899780311409115479365237372756535853291, 62289703300031234585435188246756616897767167359387015636210423567810538226487, 62357776874227535169229603723986677552237575016029450363623522209118965731477, 62742816090727067053274726868556821524033631101402012261515152539681610794161, 63324484395885397762900693586081837883926106660748610230948918800296364184787, 68536318595052838310834810610435117143127088803068602445335475326427140828313, 71333662629967127822322169475282958517332768085026414016527475771426692311137, 71818789628596987832122424763592924131858666988566206124807910367000034628553, 72686903390659724206544737536831534683324964478965218565533472954938736006029, 73733187867854099083339033682720615801689502367745526033697746193463091215391, 74963435458999407861524268290816092282448161750409920047891056819453141955557, 75170120333127044486222669300167892338904422362667312672451826995740967131303, 75389546402724552962462061186170732933053151602764277596760332277139980288183, 76425604829327821607866318415668087016313389323090875428602763671306466213509, 79395489525333852455993920714320320052245084253382013156160044439065839468327, 79656464249999345933529538948250990091001499735972420522175125449790253663599, 80114644787477907454032975169773036722948929091396695518111556258640245353257, 80759006745106776887940527633196344281100618167707846074299752297932178679679, 82874221581479658193940394796733443765246468888210669340444752189895488345711, 84468817045619298841099296118053247701538652785316191917289525698631379587559, 85092225008500173289712181614303627906592443829912221851650912999596788670459, 85263141959763159396039844302970550543465193325499728803392808980592668472247, 85317220893586781914729151221061742320435924332561513947650447739620101821641, 85440269113801669657707134806659364077593365787015642755204798072592063745773, 85527879261087022928016922730880335213911499029647505445360684307006839178647, 85605932852710450456174796386471227136632343649286364769039469217779231567929, 86107819754589869545139506654865763056227887269808133233781131410193748463851, 86163843486640208219217644606617383296879865315755352427047957187159788303323, 90506049416840638351240993555664643907544570698557428055802715993870286417397, 90981593208992230235747480738729958015954461329514397574562251177250355618859, 94292491231252601103954494535972386523808989201770556967497120902651386194197, 94647786177270050686880223709072304737527824812798720504615370320158513996239, 95245024143291248356010627064844329722889005501412707859257139919568967846749, 96080930363425942206733690433078387012542225534990227081492087888246704507441, 97503025379673346416669602471064834261095444529417927406127397664552811080519, 97933089652660434994459543027801105444314465759238615625507952727940600189809, 97989967696425430412414365007330195727579540568089381507635553281304266294483, 98528881400840757343372680020873216862352604380253902505512625033610753437887, 99954243543097817759175467071884308315066389399425962144138323810271659014209, 101194437697606745792831239895049471075868629243259633705095039109106669730049, 104839585136982979038455371159792466832240349600316352323298553695087849421381, 105456177698115744366058226841117004148984862640508652026693415913601327156663, 105968680258458596148231537242426487615777154901757802179920828015643162453013, 107215231310505428676141499322854084705449980120508349014281658724461432400217, 108453510226000323101878638579711809016925129461454736081626840494612032349563, 108912309872075893365304953396355888979232521108447384367848671194555817947569, 108997022694208058790012872910875462503431062529475661062287324154956518493253, 109322568022936420513907683387388159609608845110397725890561824119551381299491, 110029910646386857435917200277309270534213159892118369614262345955187628998231, 113144116692201726589659464242284454643667198002480615110504233499994524508369, 114364819674774846158222033218389865879337160752260853195966728903452922982539, 115473149458023487534963694928189868221104180303262395583076896364124371580681]
c = 53630975642867707857977893429296334474716191527562307357222551886495223105860
```

### Analysis:

ƒê·∫ßu ti√™n ta c√≥ h√†m ƒë·ªÉ t·∫°o ra key:
```python
def key_gen():
    ps = []
    n = randint(2,2**6)
    for _ in range(n):
        p = getPrime(256)
        ps.append(p)
    return ps
```

H√†m n√†y ch·ªâ ƒë∆°n gi·∫£n l√† t·∫°o ra `n` s·ªë nguy√™n t·ªë 256-bits, v·ªõi `n` random trong kho·∫£ng t·ª´ 2 t·ªõi 64. Ti·∫øp ƒë·∫øn l√† h√†m m√£ h√≥a:

```python
def encrypt(m, ps):
    ps.sort()
    for p in ps:
        e = 1<<1 
        m = pow(m, e, p)
    return m
```

H√†m n√†y s·∫Ω ti·∫øn h√†nh s·∫Øp x·∫øp c√°c s·ªë nguy√™n t·ªë v·ª´a gen ra, sau ƒë√≥ th·ª±c hi·ªán m√£ h√≥a message b·∫±ng c√°ch l·∫•y `m = m**2 (mod p)` l·∫ßn l∆∞·ª£t v·ªõi t·ª´ng s·ªë `p`.

V·∫≠y √Ω t∆∞·ªüng ·ªü ƒë√¢y l√† ta ch·ªâ c·∫ßn l·∫•y cƒÉn b·∫≠c 2 modulo ·ª©ng v·ªõi m·ªói p l·∫ßn l∆∞·ª£t t·ª´ p l·ªõn nh·∫•t t·ªõi nh·ªè nh·∫•t. K·∫øt qu·∫£ cu·ªëi c√πng tr·∫£ v·ªÅ s·∫Ω l√† flag. Do k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa cƒÉn b·∫≠c 2 s·∫Ω c√≥ hai k·∫øt qu·∫£, ta s·∫Ω c·∫ßn ki·ªÉm tra xem k·∫øt qu·∫£ c√≥ ph·∫£i l√† th·∫∑ng d∆∞ b·∫≠c 2 ·ª©ng v·ªõi s·ªë p ti·∫øp theo kh√¥ng ƒë·ªÉ ti·∫øp t·ª•c.

### Solution:
```python
from sage.all import *
from Crypto.Util.number import *

ps = [58320376514263631335873677765253125888698486914776244278840394907785982174227, 58471100903556849464997941473361218814224259836954194397969653104598610032001, 58604272362819290182402155417145974680722885151257754555756391392263925028373, 59492683945798085501800206338526899942899780311409115479365237372756535853291, 62289703300031234585435188246756616897767167359387015636210423567810538226487, 62357776874227535169229603723986677552237575016029450363623522209118965731477, 62742816090727067053274726868556821524033631101402012261515152539681610794161, 63324484395885397762900693586081837883926106660748610230948918800296364184787, 68536318595052838310834810610435117143127088803068602445335475326427140828313, 71333662629967127822322169475282958517332768085026414016527475771426692311137, 71818789628596987832122424763592924131858666988566206124807910367000034628553, 72686903390659724206544737536831534683324964478965218565533472954938736006029, 73733187867854099083339033682720615801689502367745526033697746193463091215391, 74963435458999407861524268290816092282448161750409920047891056819453141955557, 75170120333127044486222669300167892338904422362667312672451826995740967131303, 75389546402724552962462061186170732933053151602764277596760332277139980288183, 76425604829327821607866318415668087016313389323090875428602763671306466213509, 79395489525333852455993920714320320052245084253382013156160044439065839468327, 79656464249999345933529538948250990091001499735972420522175125449790253663599, 80114644787477907454032975169773036722948929091396695518111556258640245353257, 80759006745106776887940527633196344281100618167707846074299752297932178679679, 82874221581479658193940394796733443765246468888210669340444752189895488345711, 84468817045619298841099296118053247701538652785316191917289525698631379587559, 85092225008500173289712181614303627906592443829912221851650912999596788670459, 85263141959763159396039844302970550543465193325499728803392808980592668472247, 85317220893586781914729151221061742320435924332561513947650447739620101821641, 85440269113801669657707134806659364077593365787015642755204798072592063745773, 85527879261087022928016922730880335213911499029647505445360684307006839178647, 85605932852710450456174796386471227136632343649286364769039469217779231567929, 86107819754589869545139506654865763056227887269808133233781131410193748463851, 86163843486640208219217644606617383296879865315755352427047957187159788303323, 90506049416840638351240993555664643907544570698557428055802715993870286417397, 90981593208992230235747480738729958015954461329514397574562251177250355618859, 94292491231252601103954494535972386523808989201770556967497120902651386194197, 94647786177270050686880223709072304737527824812798720504615370320158513996239, 95245024143291248356010627064844329722889005501412707859257139919568967846749, 96080930363425942206733690433078387012542225534990227081492087888246704507441, 97503025379673346416669602471064834261095444529417927406127397664552811080519, 97933089652660434994459543027801105444314465759238615625507952727940600189809, 97989967696425430412414365007330195727579540568089381507635553281304266294483, 98528881400840757343372680020873216862352604380253902505512625033610753437887, 99954243543097817759175467071884308315066389399425962144138323810271659014209, 101194437697606745792831239895049471075868629243259633705095039109106669730049, 104839585136982979038455371159792466832240349600316352323298553695087849421381, 105456177698115744366058226841117004148984862640508652026693415913601327156663, 105968680258458596148231537242426487615777154901757802179920828015643162453013, 107215231310505428676141499322854084705449980120508349014281658724461432400217, 108453510226000323101878638579711809016925129461454736081626840494612032349563, 108912309872075893365304953396355888979232521108447384367848671194555817947569, 108997022694208058790012872910875462503431062529475661062287324154956518493253, 109322568022936420513907683387388159609608845110397725890561824119551381299491, 110029910646386857435917200277309270534213159892118369614262345955187628998231, 113144116692201726589659464242284454643667198002480615110504233499994524508369, 114364819674774846158222033218389865879337160752260853195966728903452922982539, 115473149458023487534963694928189868221104180303262395583076896364124371580681]
c = 53630975642867707857977893429296334474716191527562307357222551886495223105860

def is_quadratic_residue(a, p):
    return pow(a, (p - 1) // 2, p) == 1

ps.reverse()
def find_valid_c(ps, c):
    potential_cs = [c]
    for i, p in enumerate(ps):
        next_potential_cs = []
        for c in potential_cs:
            if is_quadratic_residue(c, p):
                Zn = Zmod(p)
                res = Zn(c).sqrt(all=True)
                if len(res) == 2:
                    res0, res1 = int(res[0]), int(res[1])
                    next_potential_cs.append(res0)
                    next_potential_cs.append(res1)
        if not next_potential_cs:
            print(f"No valid c found for p = {p}")
            return None
        potential_cs = next_potential_cs
        print(f"Potential c's after p = {p}: {potential_cs}")
    return potential_cs if potential_cs else None

final_c = find_valid_c(ps, c)
if final_c is not None:
    print(f"Final valid c: {final_c}")
else:
    print("No valid c found for all ps")

for c in final_c:
    flag = long_to_bytes(c)
    if b'AKASEC{' in flag:
        print(flag)
```

Script ng·∫Øn h∆°n (s·ª≠ d·ª•ng dfs)
```python
import sympy as sp
from Crypto.Util.number import *
ps = ps = [58320376514263631335873677765253125888698486914776244278840394907785982174227, 58471100903556849464997941473361218814224259836954194397969653104598610032001, 58604272362819290182402155417145974680722885151257754555756391392263925028373, 59492683945798085501800206338526899942899780311409115479365237372756535853291, 62289703300031234585435188246756616897767167359387015636210423567810538226487, 62357776874227535169229603723986677552237575016029450363623522209118965731477, 62742816090727067053274726868556821524033631101402012261515152539681610794161, 63324484395885397762900693586081837883926106660748610230948918800296364184787, 68536318595052838310834810610435117143127088803068602445335475326427140828313, 71333662629967127822322169475282958517332768085026414016527475771426692311137, 71818789628596987832122424763592924131858666988566206124807910367000034628553, 72686903390659724206544737536831534683324964478965218565533472954938736006029, 73733187867854099083339033682720615801689502367745526033697746193463091215391, 74963435458999407861524268290816092282448161750409920047891056819453141955557, 75170120333127044486222669300167892338904422362667312672451826995740967131303, 75389546402724552962462061186170732933053151602764277596760332277139980288183, 76425604829327821607866318415668087016313389323090875428602763671306466213509, 79395489525333852455993920714320320052245084253382013156160044439065839468327, 79656464249999345933529538948250990091001499735972420522175125449790253663599, 80114644787477907454032975169773036722948929091396695518111556258640245353257, 80759006745106776887940527633196344281100618167707846074299752297932178679679, 82874221581479658193940394796733443765246468888210669340444752189895488345711, 84468817045619298841099296118053247701538652785316191917289525698631379587559, 85092225008500173289712181614303627906592443829912221851650912999596788670459, 85263141959763159396039844302970550543465193325499728803392808980592668472247, 85317220893586781914729151221061742320435924332561513947650447739620101821641, 85440269113801669657707134806659364077593365787015642755204798072592063745773, 85527879261087022928016922730880335213911499029647505445360684307006839178647, 85605932852710450456174796386471227136632343649286364769039469217779231567929, 86107819754589869545139506654865763056227887269808133233781131410193748463851, 86163843486640208219217644606617383296879865315755352427047957187159788303323, 90506049416840638351240993555664643907544570698557428055802715993870286417397, 90981593208992230235747480738729958015954461329514397574562251177250355618859, 94292491231252601103954494535972386523808989201770556967497120902651386194197, 94647786177270050686880223709072304737527824812798720504615370320158513996239, 95245024143291248356010627064844329722889005501412707859257139919568967846749, 96080930363425942206733690433078387012542225534990227081492087888246704507441, 97503025379673346416669602471064834261095444529417927406127397664552811080519, 97933089652660434994459543027801105444314465759238615625507952727940600189809, 97989967696425430412414365007330195727579540568089381507635553281304266294483, 98528881400840757343372680020873216862352604380253902505512625033610753437887, 99954243543097817759175467071884308315066389399425962144138323810271659014209, 101194437697606745792831239895049471075868629243259633705095039109106669730049, 104839585136982979038455371159792466832240349600316352323298553695087849421381, 105456177698115744366058226841117004148984862640508652026693415913601327156663, 105968680258458596148231537242426487615777154901757802179920828015643162453013, 107215231310505428676141499322854084705449980120508349014281658724461432400217, 108453510226000323101878638579711809016925129461454736081626840494612032349563, 108912309872075893365304953396355888979232521108447384367848671194555817947569, 108997022694208058790012872910875462503431062529475661062287324154956518493253, 109322568022936420513907683387388159609608845110397725890561824119551381299491, 110029910646386857435917200277309270534213159892118369614262345955187628998231, 113144116692201726589659464242284454643667198002480615110504233499994524508369, 114364819674774846158222033218389865879337160752260853195966728903452922982539, 115473149458023487534963694928189868221104180303262395583076896364124371580681]
c = 53630975642867707857977893429296334474716191527562307357222551886495223105860
ps = ps[::-1]

def find_flag(ct, i):
    if i == len(ps):
        return print(long_to_bytes(ct))
    roots = sp.sqrt_mod(ct, ps[i], all_roots=True)
    if roots != None:
        for r in roots:
            find_flag(r, i+1)
            
find_flag(c, 0)
```
Flag: *AKASEC{akasec+palestine=<3}*

## Twin
### Description:
I have a twin but he doesn't looks like me !!, so sad isn't !?

### Attachments:
*chal.py*
```python
from Crypto.Util.number import getPrime, bytes_to_long
from SECRET import FLAG

e = 5
p = getPrime(256)
q = getPrime(256)
n = p * q

m1 = bytes_to_long(FLAG)
m2 = m1 >> 8

if __name__ == "__main__":
    c1, c2 = pow(m1, e, n), pow(m2, e, n)
    print("n = {}\nc1 = {}\nc2 = {}".format(n, c1, c2))
```

*out.txt*
```
n = 6689395968128828819066313568755352659933786163958960509093076953387786003094796620023245908431378798689402141767913187865481890531897380982752646248371131
c1 = 3179086897466915481381271626207192941491642866779832228649829433228467288272857233211003674026630320370606056763863577418383068472502537763155844909495261
c2 = 6092690907728422411002652306266695413630015459295863614266882891010434275671526748292477694364341702119123311030726985363936486558916833174742155473021704
```

### Analysis:
L·∫°i l√† m·ªôt b√†i v·ªÅ RSA, l·∫ßn n√†y `e` v·∫´n t∆∞∆°ng ƒë·ªëi nh·ªè (e = 5). ƒê·ªÅ b√†i cho ta bi·∫øt `n` v√† m√£ h√≥a c·ªßa `m1`, `m2` v·ªõi `m1` ch√≠nh l√† flag v√† `m2 = m1 >> 8`.

·ªû ƒë√¢y th√¨ `m2 = m1 >> 8` nghƒ©a l√† `m2` ch√≠nh l√† `m1` nh∆∞ng b·ªã m·∫•t ƒëi 8-bits = 1-bytes cu·ªëi. Do `m1` l√† flag n√™n ta bi·∫øt r·∫±ng byte cu·ªëi ƒë√≥ ch√≠nh l√† `"}"`.

V·ªõi 2 ciphertext c·ªßa 2 message m√† ta ƒë√£ bi·∫øt m·ªôt ph·∫ßn kh√°c nhau nh·∫•t ƒë·ªãnh, m√¨nh s·∫Ω s·ª≠ d·ª•ng **Franklin‚ÄìReiter related-message attack** ƒë·ªÉ gi·∫£i b√†i n√†y.

### Solution:
> `f1 = x**e - c2` n√™n x s·∫Ω l√† flag b·ªã thi·∫øu ƒëi "}"
=>   `f2 = (2**(1*8) * x + ord("}"))**e - c1` (2^(1*8) * x ch√≠nh l√† d·ªãch tr√°i 8-bits)

```python
from Crypto.Util.Padding import pad
from Crypto.Util.number import *
from sage.all import *

n = 6689395968128828819066313568755352659933786163958960509093076953387786003094796620023245908431378798689402141767913187865481890531897380982752646248371131
c1 = 3179086897466915481381271626207192941491642866779832228649829433228467288272857233211003674026630320370606056763863577418383068472502537763155844909495261
c2 = 6092690907728422411002652306266695413630015459295863614266882891010434275671526748292477694364341702119123311030726985363936486558916833174742155473021704
e = 5

pgcd = lambda g1, g2: g1.monic() if not g2 else pgcd(g2, g1%g2)

x = PolynomialRing(Zmod(n), 'x').gen()
f1 = x**e - c2
f2 = (2**(1*8) * x + ord("}"))**e - c1

g = int(-pgcd(f1, f2)[0])
print(long_to_bytes(g) + b'}')
```
Flag: *AKASEC{be_on_the_right_side_of_history_free_palestine}*

## GCL
### Description:
All about THEORIC and some LUCK.

### Attachments:
*chal.py*
```python
from random import getrandbits
from Crypto.Util.number import getPrime
from SECRET import FLAG

BITS = 128
m = getPrime(BITS)
s = getrandbits(BITS - 1)
a = getrandbits(BITS - 1)
b = getrandbits(BITS - 1)

def lcg(s, c):
    return c*(a*s + b) % m

if __name__ == "__main__":
    c = []
    r = s
    for i in FLAG:
        r = lcg(r, ord(i))
        c.append(r)
    print("m = {}\nc = {}".format(m, c))
```

*out.txt*
```
m = 188386979036435484879965008114174264991
c = [139973581469094519216727575374900351861, 72611500524424820710132508411012420565, 140250284171774823110472025667980956543, 32777758636601391326104783245836052689, 93866424818360655182957373584240082579, 171863599957625964609271128026424910780, 79519361871833866309751703823833758895, 157560014678333843523667019607330519198, 124975940725420603096426178838171348774, 3564693226938115115868719960412136082, 171740395033004244209129576880703758137, 92351702560499873288607191820522016910, 150094682983991168941275074808189562445, 85216665671310516224623100332845098274, 16595528649897543867800038656511154165, 19125026372283368463438507438570762609, 176795229245184227193627490600890111381, 12405536363393343486876802251851443164, 21411546298976790262184367895329536928, 182888536880153351183725282563493758721, 138117470020493616013148815568927291737, 32287599436436170232396368906599005001, 163785640221676961026807618948041121515, 73960913430365454320029097511676942987, 15454719718422589834477927328058381231, 187548967342452768771256903662911504220, 159561161576243464490176365717896800999, 68751190791869748062871941359673493536, 121231243784105483671509398006895458898, 14881767206744163076100305953646446453, 175267890044871169868897060667629218625, 147751087332703693307658387948934053643, 144192171120888146499506968416035431150]
```

### Analysis:
ƒê√¢y l√† m·ªôt b√†i v·ªÅ bi·∫øn th·ªÉ c·ªßa **Linear Congruential Generator (LCG)**. C·ª• th·ªÉ, thay v√¨ l·∫•y `(a*s + b) % m`, ta c√≥ nh∆∞ sau:

```python
def lcg(s, c):
    return c*(a*s + b) % m
```

V·ªõi `c` ch√≠nh l√† c√°c k√≠ t·ª± c·ªßa flag

```python
for i in FLAG:
        r = lcg(r, ord(i))
        c.append(r)
```

Tuy nhi√™n, c≈©ng v√¨ th·∫ø m√† thu·∫≠t to√°n n√†y s·∫Ω r·∫•t d·ªÖ b·ªã ph√° n·∫øu ta bi·∫øt 3 k√≠ t·ª± ƒë·∫ßu c·ªßa flag l√† "AKA" v√† 3 ciphertext t∆∞∆°ng ·ª©ng. Ta s·∫Ω c√≥ 3 ph∆∞∆°ng tr√¨nh nh∆∞ sau:

$$ c_0 = 65.(as + b) \pmod{m} $$  
$$ c_1 = 75.(ac_0 + b) \pmod{m} $$  
$$ c_2 = 65.(ac_1 + b) \pmod{m} $$

T·ª´ ph∆∞∆°ng tr√¨nh (3), ta c√≥ th·ªÉ r√∫t ra a:

$$ a = (65^{-1}c_2 - b).c1^{-1} \pmod{m} $$

T·ª´ ph∆∞∆°ng tr√¨nh (1) v√† (2), ta s·∫Ω c√≥ ƒë∆∞·ª£c ph∆∞∆°ng tr√¨nh c·ªßa b theo a:

$$ b = (75^{-1}c_1 - ac_0) \pmod{m} $$  

Th·∫ø v√†o ph∆∞∆°ng tr√¨nh s·ªë (3) ta s·∫Ω c√≥ nh∆∞ sau:

$$ a = (65^{-1}c_2 - 75^{-1}c_1 + ac_0).c1^{-1} \pmod{m} $$  
$$  \Leftrightarrow a(c_1 - c_0) = (65^{-1}c_2 - 75^{-1}c_1) \pmod{m} $$  
$$  \Leftrightarrow a = (65^{-1}c_2 - 75^{-1}c_1)(c_1 - c_0)^{-1} \pmod{m} $$

Khi ƒë√£ t√≠nh ƒë∆∞·ª£c `a`, ta s·∫Ω thay ng∆∞·ª£c l·∫°i ƒë·ªÉ t√≠nh `b`. Sau ƒë√≥ t√≠nh ra `s` b·∫±ng c√¥ng th·ª©c sau:

$$ s = (65^{-1}c_0 - b).a^{-1} \pmod{m} $$ 

C√≥ ƒë·ªß `a`, `b` v√† `s`, ta ch·ªâ c·∫ßn bruteforce t·ª´ng k√≠ t·ª± c·ªßa flag, n·∫øu h√†m `lcg` n√†y tr·∫£ v·ªÅ gi√° tr·ªã ƒë√∫ng nh∆∞ trong m·∫£ng `c` th√¨ ƒë√≥ l√† k√≠ t·ª± ƒë√∫ng.

### Solution:
```python
from Crypto.Util.number import *

m = 188386979036435484879965008114174264991
c = [139973581469094519216727575374900351861, 72611500524424820710132508411012420565, 140250284171774823110472025667980956543, 32777758636601391326104783245836052689, 93866424818360655182957373584240082579, 171863599957625964609271128026424910780, 79519361871833866309751703823833758895, 157560014678333843523667019607330519198, 124975940725420603096426178838171348774, 3564693226938115115868719960412136082, 171740395033004244209129576880703758137, 92351702560499873288607191820522016910, 150094682983991168941275074808189562445, 85216665671310516224623100332845098274, 16595528649897543867800038656511154165, 19125026372283368463438507438570762609,
     176795229245184227193627490600890111381, 12405536363393343486876802251851443164, 21411546298976790262184367895329536928, 182888536880153351183725282563493758721, 138117470020493616013148815568927291737, 32287599436436170232396368906599005001, 163785640221676961026807618948041121515, 73960913430365454320029097511676942987, 15454719718422589834477927328058381231, 187548967342452768771256903662911504220, 159561161576243464490176365717896800999, 68751190791869748062871941359673493536, 121231243784105483671509398006895458898, 14881767206744163076100305953646446453, 175267890044871169868897060667629218625, 147751087332703693307658387948934053643, 144192171120888146499506968416035431150]

x0 = c[0]
x1 = c[1]
x2 = c[2]

a = ((x2*inverse(ord('A'), m) - x1*inverse(ord('K'), m))*inverse(x1 - x0, m)) % m
b = (x1*inverse(ord('K'), m) - a*x0) % m
s = ((x0*inverse(ord('A'), m) - b)*inverse(a, m)) % m

def lcg(s, c):
    return c*(a*s + b) % m

p = []
r = s
for i in c:
    for j in range(33,126):
        if(lcg(r, j) == i):
            p.append(chr(j))
            r = lcg(r, j)
            break

flag = ''.join(p)
print(flag)
```
Flag: *AKASEC{++see_?!_just_some_math--}*

### Another solution:
M·ªôt c√°ch gi·∫£i kh√°c l√† s·ª≠ d·ª•ng `groebner_basis` trong v√†nh h·ªØu h·∫°n. Ta s·∫Ω c√≥ 8 ƒëa th·ª©c t·ª´ 8 k√≠ t·ª± ƒë√£ bi·∫øt c·ªßa flag form. K·ª≥ v·ªçng c·ªßa ch√∫ng ta l√† n√≥ s·∫Ω ra ƒë∆∞·ª£c c√°c ƒëa th·ª©c ch·ªâ ch·ª©a `a` ho·∫∑c `b` lu√¥n.

M√¨nh s·∫Ω s·ª≠ d·ª•ng **sagemath**:
```python
P.<a,b> = PolynomialRing(Zmod(m), order='lex')
flag_form = 'AKASEC{'
eq = []
for i in range(1, 7):
    eq.append(ord(flag_form[i])*(a*ct[i-1] + b) - ct[i])
eq.append(ord('}')*(a*ct[31] + b) - ct[32])

I = ideal(eq)
print(I.groebner_basis())

# [a + 130507591207059696366651686185689099048, b + 65133415165202666396914997167577762424]
```
T·ª´ ƒë√¢y m√¨nh c√≥ th·ªÉ kh√¥i ph·ª•c l·∫°i `a`, `b` s·ª≠ d·ª•ng:

```python 
a = -130507591207059696366651686185689099048 % m
b = -65133415165202666396914997167577762424 % m
```

Vi·ªác t√≠nh `s` v·∫´n s·∫Ω gi·ªëng nh∆∞ ban ƒë·∫ßu, v√† ta s·∫Ω c√≥ ƒë∆∞·ª£c flag.

### Another another solution:
S·ª≠ d·ª•ng ma tr·∫≠n
```python
# s -> CHAR * (a s + b) -> CHAR s a + CHAR b
# m, c = enc()

c0, c1, c2 = c[:3]
k1, k2 = [i for i in b'KA'] # since we know flag starts with AKASEC

# Solve system of equations using matrices
"""
c1 = K * c0 a + K * b
c2 = A * c1 a + A * b
"""
M = Matrix(Zmod(m), [[k1 * c0, k1], [k2 * c1, k2]])
v = vector(Zmod(m), [c1, c2])
a, b = [int(i) for i in M.solve_right(v)]
```

## My Calculus Lab
### Description:
We share a secret key between us in the calculus lab, We hope no outsider could get to it :)

And never forget: #FreePalestine üáµüá∏

### Attachments:
*chal.py*
```python
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import hashlib
import sympy as sp
import random

FLAG = b'REDACTED'

key = random.getrandbits(7)

x = sp.symbols('x')

f = "REDACTED"
f_prime = "REDACTED"
f_second_prime = "REDACTED"

assert(2*f_second_prime - 6*f_prime + 3*f == 0)
assert(f.subs(x, 0) | f_prime.subs(x, 0) == 14)

def encrypt(message, key):
    global f
    global x
    point = f.subs(x, key).evalf(100)
    point_hash = hashlib.sha256(str(point).encode()).digest()[:16]
    cipher = AES.new(point_hash, AES.MODE_CBC)
    iv = cipher.iv
    ciphertext = cipher.encrypt(pad(message, AES.block_size))
    return iv.hex() + ciphertext.hex()

encrypted = encrypt(FLAG, key)

print(f"Key: {key}")
print(f"Encrypted: {encrypted}")
```

*enc.txt*
```
Key: 60
Encrypted: 805534c14e694348a67da0d75165623cf603c2a98405b34fe3ba8752ce24f5040c39873ec2150a61591b233490449b8b7bedaf83aa9d4b57d6469cd3f78fdf55
```

### Analysis:
B√†i n√†y y√™u c·∫ßu ch√∫ng ta ph·∫£i gi·∫£i m·ªôt ph∆∞∆°ng tr√¨nh vi ph√¢n c·∫•p hai thu·∫ßn nh·∫•t:

$$ 2f''(x) - 6f'(x) + 3f(x) = 0 $$ 

ƒê·ªÉ gi·∫£i ph∆∞∆°ng tr√¨nh n√†y, ta s·∫Ω ƒë·∫∑t nh∆∞ sau:

$$ f(x) = e^{rt} $$  
$$ \Leftrightarrow f'(x) = re^{rt} $$  
$$ \Leftrightarrow f''(x) = r^{2}e^{rt} $$  

Khi ƒë√≥ ph∆∞∆°ng tr√¨nh vi ph√¢n c·ªßa ta s·∫Ω tr·ªü th√†nh:

$$ 2r^{2}e^{rt} - 6re^{rt} + 3e^{rt} = 0 $$ 
$$ \Leftrightarrow 2r^{2} - 6r + 3 = 0 $$
$$ \Leftrightarrow r = \frac{3 \pm \sqrt{3}}{2} $$  

V·∫≠y ph∆∞∆°ng tr√¨nh c·∫ßn t√¨m c·ªßa ta s·∫Ω c√≥ d·∫°ng:

$$ f(x) = C_1e^{\frac{3 + \sqrt{3}}{2}} + C_2e^{\frac{3 - \sqrt{3}}{2}} $$  

Gi·ªù ƒë·ªÉ t√¨m ra C1 v√† C2, m√¨nh s·∫Ω d·ª±a v√†o ƒëi·ªÅu ki·ªán c√≤n l·∫°i l√†:

$$ f(0) | f'(0) = 14 $$

V√¨ l√† OR n√™n 2 gi√° tr·ªã n√†y ch·ªâ c√≥ th·ªÉ l√† c√°c s·ªë nguy√™n kh√¥ng √¢m. V√¨ v·∫≠y m√¨nh c√≥ th·ªÉ bruteforce 2 gi√° tr·ªã n√†y v√† thay v√†o ƒë·ªÉ t√¨m ra C1, C2. ƒêo·∫°n sau th√¨ t∆∞∆°ng ƒë·ªëi ƒë∆°n gi·∫£n:

```python
def encrypt(message, key):
    global f
    global x
    point = f.subs(x, key).evalf(100)
    point_hash = hashlib.sha256(str(point).encode()).digest()[:16]
    cipher = AES.new(point_hash, AES.MODE_CBC)
    iv = cipher.iv
    ciphertext = cipher.encrypt(pad(message, AES.block_size))
    return iv.hex() + ciphertext.hex()
```

Ch·ªâ c·∫ßn ph∆∞∆°ng tr√¨nh f(x) ƒë√∫ng th√¨ ta s·∫Ω c√≥ ƒë∆∞·ª£c key = SHA256 c·ªßa ƒëi·ªÉm f(60). S·ª≠ d·ª•ng key n√†y v√† iv ƒë∆∞·ª£c cho, ta s·∫Ω gi·∫£i m√£ ƒë∆∞·ª£c ciphertext.

### Solution:
> M√¨nh c√≥ ki·∫øm ƒë∆∞·ª£c h√†m `generate_or_number` ƒë·ªÉ c√≥ th·ªÉ t·∫°o ra c√°c t·∫≠p s·ªë m√† khi ƒëem OR c√≥ th·ªÉ ra ƒë∆∞·ª£c 14 s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p ph√¢n t√≠ch bit. D√π ch∆∞a hi·ªÉu thu·∫≠t to√°n l·∫Øm nh∆∞ng sure l√† n√≥ s·∫Ω nhanh h∆°n l√† ph·∫£i bruteforce v√† cho if i OR j == 14.

```python
import sympy as sp
from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
import hashlib

key = 60
c = "805534c14e694348a67da0d75165623cf603c2a98405b34fe3ba8752ce24f5040c39873ec2150a61591b233490449b8b7bedaf83aa9d4b57d6469cd3f78fdf55"

def generate_or_number(target):
    bits = [1 << i for i in range(target.bit_length()) if (target & (1 << i)) != 0]
    result = set()
    from itertools import combinations
    for r in range(1, len(bits) + 1):
        for combo in combinations(bits, r):
            result.add(sum(combo))
    return sorted(result)

def decrypt(encrypted, key):
    global f
    global x

    iv = bytes.fromhex(encrypted[:32])
    ciphertext = bytes.fromhex(encrypted[32:])

    point = f.subs(x, key).evalf(100)
    point_hash = hashlib.sha256(str(point).encode()).digest()[:16]

    cipher = AES.new(point_hash, AES.MODE_CBC, iv)
    plaintext = cipher.decrypt(ciphertext)
    return plaintext

num = generate_or_number(14)

for i in num:
    for j in num:
            x = sp.symbols('x')
            f = sp.Function('f')(x)

            diff_eq = sp.Eq(2 * f.diff(x, x) - 6 * f.diff(x) + 3 * f, 0)
            initial_conditions = {f.subs(x, 0): i, f.diff(x).subs(x, 0): j}

            solution = sp.dsolve(diff_eq, f, ics=initial_conditions)
            f = solution.rhs

            flag = decrypt(c, key)
            if b'AKASEC{' in flag:
                print(unpad(flag, AES.block_size))
```
Flag: *AKASEC{d1d_y0u_3nj0y_c41cu1u5_101?}*

## Magic
### Description:
All you get is the connection you have.

`nc 20.80.240.190 4455`

### Analysis:
M·ªôt b√†i Crypto Whitebox. Giao di·ªán khi m√¨nh netcat s·∫Ω ki·ªÉu nh∆∞ n√†y:

```shell
n = 124858453996774455175831237388783456398873494792971534641906593064537398606270863687615782631563971824220106303414117271215470665630424707020365712474872798752936619693658594537474951526449646751480630953832851092088734049143563437606303122506401788268787791664153473572604493281992887617340576760054562144297
e = 65537

give your magic number: 1
c = 54739498014692963670739255550344626839445909610063788802683284026293460826482290173768557045615462186610937675965434695533690448343063180587058949839814986540261450067227916997341400495137845218409544388160751581358971277285247630794369080577276575925690991671623026071614843923134539883727934573958033023385
give your magic number: 2
c = 118563924084288350979875911826911648451492417410190442729605150398990172742114706881713513260026456606361974691958281592863308845429539916753212690715752514045536515126148415165012770596068180597350731418026863309021787875428315105983955850026374009526923946370126032394401959157207131917483677062468325010139
give your magic number: a
Are sure about that ...
```

Ch∆∞∆°ng tr√¨nh s·∫Ω cho ch√∫ng ta bi·∫øt `n`, `e`, c√≥ v·∫ª ƒë√¢y l√† m·ªôt b√†i RSA. ·ª®ng v·ªõi m·ªói m·ªôt "magic number", ch∆∞∆°ng tr√¨nh s·∫Ω tr·∫£ v·ªÅ cho ta m·ªôt ciphertext. "Magic number" n√†y c≈©ng ch·ªâ ƒë∆∞·ª£c ph√©p l√† s·ªë.

Khi th·ª≠ m·ªôt s·ªë to, m√¨nh nh·∫≠n th·∫•y k·∫øt qu·∫£ ƒë·ªÅu tr·∫£ v·ªÅ c = 0, cho t·ªõi khi m√¨nh th·ª≠ v·ªõi s·ªë 302 th√¨ n√≥ tr·∫£ v·ªÅ c = 1:

```shell
give your magic number: 9999
c = 0
give your magic number: 500
c = 0
give your magic number: 400
c = 0
give your magic number: 302
c = 1
give your magic number: 303
c = 0
give your magic number: 301
c = 72592243079603522342723072993871394189245725180498884385863982114511838189853009543721573492376155248328952188516016422657555215043864179687970092202705626295576941426682185514867524107348572559147337091889285885078737999247938685841077300540341929945354748124529558959257545661913342915494168681418868293887
```

ƒê·∫øn ƒë√¢y th√¨ m√¨nh ƒëo√°n ƒë∆∞·ª£c khi "magic number" l√† 302 th√¨ m = 1 ho·∫∑c e = 0 th√¨ m·ªõi t·∫°o ra c nh∆∞ v·∫≠y ƒë∆∞·ª£c. Cho t·ªõi khi m√¨nh th·ª≠ v·ªõi m·ªôt s·ªë √¢m

```shell
give your magic number: -1
can't shif... Nevermind
```

ƒê·∫øn ƒë√¢y th√¨ m√¨nh c≈©ng ƒëo√°n ra ƒë∆∞·ª£c n√≥ s·ª≠ d·ª•ng bit shift s·ªë "magic number" sau ƒë√≥ in ra ciphertext. ·ª®ng v·ªõi gi·∫£ thuy·∫øt m = 1 ho·∫∑c e = 0 th√¨ m√¨nh ƒëo√°n ciphertext s·∫Ω c√≥ d·∫°ng:

$$ c = (m >> 302)^e \pmod{n} $$  

C√≥ nghƒ©a l√† `m` s·∫Ω l√† m·ªôt s·ªë nguy√™n 303-bits. V·∫≠y m√¨nh s·∫Ω bruteforce t·ª´ng k√≠ t·ª± c·ªßa `m` b·∫±ng c√°ch g·ª≠i l·∫ßn l∆∞·ª£t magic number gi·∫£m d·∫ßn. C·ª• th·ªÉ:

$$ m >> 302 = 1 $$  
$$ \Leftrightarrow \left[ \begin{array}{l}m >> 301 = 10 \\ m >> 301 = 11 \end{array} \right. $$  

T∆∞∆°ng t·ª± v·ªõi c√°c bit c√≤n l·∫°i. N·∫øu m >> 301 = 10 th√¨ m >> 300 = 100 ho·∫∑c m >> 300 = 101. Vi·ªác ch·ªçn ra ƒë∆∞·ª£c c√°i n√†o s·∫Ω ƒë∆∞·ª£c t√≠nh b·∫±ng c√°ch so s√°nh v·ªõi c tr·∫£ v·ªÅ.

### Solution:
```python
from pwn import *
from Crypto.Util.number import *
from tqdm import tqdm

conn = remote('20.80.240.190', 4455)

n = int(conn.recvline().decode().strip()[3:])
e = int(conn.recvline().decode().strip()[3:])
print("n = ", n)
print("e = ", e)
conn.recvline()

bits = "1"
for i in tqdm(range(301, -1, -1)):
    zero = int(bits + '0', 2)
    one = int(bits + '1',2)

    conn.sendline(str(i).encode())
    c = int(conn.recvline().decode().strip()[28:])
    
    if(pow(zero, e, n) == c):
        bits += '0'
    else:
        bits += '1'

print(bits)

flag = long_to_bytes(int(bits, 2))
print(flag)
```
Flag: *AKASEC{7alawa_ayayay_tbt_m3ana_asa7bi}*

## DODOLOUF
### Description:
This was supposed to be the warmup challenge.

`nc 20.80.240.190 4447`

### Attachment:
*Chall.py*
```python
from os import urandom
from random import getrandbits
from Crypto.Cipher import AES
from Crypto.Util.number import long_to_bytes
from Crypto.Util.Padding import pad
import pickle
import time

def generate_number(bits):
    return getrandbits(bits)

class myencryption():
    def __init__(self):
        self.key_counter = 0
        self.encryptions_count = 0
        self.still_single = True
        self.keys = []
        self.username = ""
        self.iv = urandom(16)

    def generate_key(self):
        key = getrandbits(128)
        return long_to_bytes(key)

    def get_recognizer(self):
        self.recognizer = {"id": int(time.time()) * 0xff, "username": self.username, "is_admin": False, "key": self.keys[self.key_counter].hex()}

    def encrypt(self):
        key = self.generate_key()
        self.keys.append(key)
        self.encryptions_count += 1
        self.get_recognizer()
        cipher = AES.new(key, AES.MODE_CBC, iv=self.iv)
        return cipher.encrypt(pad(pickle.dumps(self.recognizer), 16))

    def decrypt(self, data):
        key = self.keys[self.key_counter]
        cipher = AES.new(key, AES.MODE_CBC, iv=self.iv)
        return pickle.loads(cipher.decrypt(data))

header = "=========================================================================================="

def logs(cipher):
    print("Welcome to your inbox !")
    print("---> You have 1 message <---")
    print(f"---> You have encrypted a text {cipher.encryptions_count} times.")
    print(f"---> Unfortunatly you are still single." if cipher.still_single else "You are in a relationship.")
    print(f"---> The current key that was used to encrypt is {cipher.keys[cipher.key_counter].hex()}.")
    print("Thank you for using our service !")

def main():
    cipher = myencryption()
    cipher.username = input("What can I call you ? ")
    print("IV used during this session: ", cipher.iv.hex())
    print(header)
    while True:
        token = cipher.encrypt()
        print("Your new token is : ", token.hex())
        print("Menu:\n1. Logs\n2. Get Flag\n3. Exit")
        choice = int(input("Enter your choice: "))
        if choice == 1:
            session_id = bytes.fromhex(input("Would you kindly input your session id: "))
            cipher.iv = session_id[:16]
            decrypted_token = cipher.decrypt(session_id[16:])
            if decrypted_token['is_admin'] == True:
                logs(cipher)
            else:
                print("My apologies, but this is reserved for the admins only.")
        elif choice == 2:
            print("In order to get the flag, you must prove that you are the admin.")
            your_bet = input("What is the key that I'm going to use next ?")
            if your_bet == cipher.generate_key().hex():
                print("Congratulation ! Here is the flag: AKASEC{nn_hh}")
            else:
                print("I am sorry, but you are not the admin.")
                exit()
        elif choice == 3:
            exit()
        else:
            print("Invalid choice. Please try again.")
        cipher.key_counter += 1

if __name__ == "__main__":
    main()
```

### Analysis:


### Solution:

## BOSS LEVEL
### Description:
This challenge is based on Cryptanalysis.

It's time for you to know if you really like crypto, or you just good at it.

It's time to know if you're a follower.

And why do Cryptanalysis gets so much hate ?

Good luck to you all !

`nc 20.80.240.190 4446`

> Hint: "The alphabet used is : REDABCFGHIJKLMNOPQSTUVWXYZ"

### Attachment:
*Ciphertext*
```
VMQPEQWTTUUWENDRTJXPHLLQGAUPIDEQRDYAMJLFVUNLGSNZFUUNS.TFR,EKJOOQSERQGKOFWLQOYWLGGPOYWOFVEEIACTKDEGQHRH'BOGYMSCSIGC.VJUJQSOCRDEBVWMFLSQS,FRUDEOGVALWXPGAVFR.PAHCOCGSG,IQMFLSNGJMFUIQZLEFIAEWLRZRLF,DFVKDXVZFPBUE;FSFGTKCXZKHRDDOKSYBWIF.ICGTTDXYLRZELFRVQRWEXUJQVTEQUCQBHDWGV,HGTUXUJWGXEJGKOKUEADBQVGMHBVUELCOHSR'KGJOH.ZM'SUDWGPVUVVOKKVBVIOUSSRDEGVAJ,CWX.DVTFSIYFGSLHCLTG.ZMRWBOUSTSULGDFL.FHPNGFCUUZNGVBEHX.ARATSULGDFL'JWEBOAVKMLRDFL...GMIVFBOKVJBFBBJDYDOVELTVXEBB.NU'BOIOYWUJDFFVJUKAUWMBUBXYLEFLYSGOVTNJGNFCGGJPIEHT'VLRSGMCDVROSRVDIOY,FRUFYIOBTGVE,QUCLGYUFZFLJ.XAGDBHGG'D.QUCHT'TJFSSHBQVOIAREGPGNFCYWNG.IQNNU'IOEBLP,NJNBTVJKJPVIS.OVFTGOOVF?KQQL'CKWSVODHU.CWQOXNJPUSQUJUHMXFJGEWWZLDVPOVSDKFKFYGENH?WAGVDIJSGFPEKJNOVIKQOTFPTKOYWREYDDCLVEOVGYGXGENMGXFUBDTXTUDNVEOTWIJYUYPDJLRCWWAE?ATIPTDWUMQKEGURRYIAFPWLXPUTQFJPZNIBSDRWWJSPURI?KQQLAISQQICIMJNQFPEXVDEVPVXZNLGSRKOXNXGHFPEEAGNVGWOGF.ERLGD'RYVIGHTKHAMSZI.GXOLVKKSTWEWTSGENHLXPUMRKLDVEXSSDZZDTXTU.HHTTASEPFWAOUDEECLLISNOKWAGOHEFWLIIAUATIEEHMHNOOHCULLMTHLOWAOYNIHUSTLOIGGLWOWIIWMRI.IOIROK.DYYOYSWSTSUIIDHNEPYOAVFTAL.
```

### Analysis:

### Solution:
