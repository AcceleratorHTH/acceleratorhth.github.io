---
title: UIUCTF 2024
description: CTF-Crypto
author: Pr0pylTh10ur4C1L
date: 2024-06-30 21:45:00 +0700
categories: [Capture The Flag]
tags: [Cryptography]
math: true
mermaid: true
---

## X Marked the Spot
### Description:
A perfect first challenge for beginners. Who said pirates can't ride trains...

### Attachments:
*public.py*
```python
from itertools import cycle

flag = b"uiuctf{????????????????????????????????????????}"
# len(flag) = 48
key  = b"????????"
# len(key) = 8
ct = bytes(x ^ y for x, y in zip(flag, cycle(key)))

with open("ct", "wb") as ct_file:
    ct_file.write(ct)
```

*ct* (bin file)

### Analysis:
Bài này là một bài mã hóa stream cơ bản. Mình đã biết 7-bytes của flag, và key dài 8-bytes nên mình có thể khôi phục lại 7-bytes đầu của key bằng cách xor ngược lại và kí tự cuối sẽ brute-force để giải ra flag.

### Solution:
```python
from pwn import *
from Crypto.Util.number import *

with open("ct", "rb") as ciphertext:
    ct = ciphertext.read()

for i in range(256):
    key = xor(ct, b'uiuctf{' + chr(i).encode())[:8]
    try:
        flag = xor(ct, key).decode()
        if flag[-1] == "}":
            print(flag)
    except:
        continue
```
Flag: *uiuctf{n0t_ju5t_th3_st4rt_but_4l50_th3_3nd!!!!!}*

## Without a Trace
### Description:
Gone with the wind, can you find my flag?

`ncat --ssl without-a-trace.chal.uiuc.tf 1337`

### Attachment:
*server.py*
```python
import numpy as np
from Crypto.Util.number import bytes_to_long
from itertools import permutations
from SECRET import FLAG


def inputs():
    print("[WAT] Define diag(u1, u2, u3. u4, u5)")
    M = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]
    for i in range(5):
        try:
            M[i][i] = int(input(f"[WAT] u{i + 1} = "))
        except:
            return None
    return M

def handler(signum, frame):
    raise Exception("[WAT] You're trying too hard, try something simpler")

def check(M):
    def sign(sigma):
        l = 0
        for i in range(5):
            for j in range(i + 1, 5):
                if sigma[i] > sigma[j]:
                    l += 1
        return (-1)**l

    res = 0
    for sigma in permutations([0,1,2,3,4]):
        curr = 1
        for i in range(5):
            curr *= M[sigma[i]][i]
        res += sign(sigma) * curr
    return res

def fun(M):
    f = [bytes_to_long(bytes(FLAG[5*i:5*(i+1)], 'utf-8')) for i in range(5)]
    F = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]
    for i in range(5):
        F[i][i] = f[i]

    try:
        R = np.matmul(F, M)
        return np.trace(R)

    except:
        print("[WAT] You're trying too hard, try something simpler")
        return None

def main():
    print("[WAT] Welcome")
    M = inputs()
    if M is None:
        print("[WAT] You tried something weird...")
        return
    elif check(M) == 0:
        print("[WAT] It's not going to be that easy...")
        return

    res = fun(M)
    if res == None:
        print("[WAT] You tried something weird...")
        return
    print(f"[WAT] Have fun: {res}")

if __name__ == "__main__":
    main()
```

### Analysis:
Bài này ta có một loạt các hàm liên quan tới ma trận. Với hàm đọc input của người dùng ta có như sau:
```python
def inputs():
    print("[WAT] Define diag(u1, u2, u3. u4, u5)")
    M = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]
    for i in range(5):
        try:
            M[i][i] = int(input(f"[WAT] u{i + 1} = "))
        except:
            return None
    return M
```

Hàm này cho phép chúng ta nhập input vào một ma trận đường chéo 5x5. Tiếp đến ta có hàm `check`:
```python
def check(M):
    def sign(sigma):
        l = 0
        for i in range(5):
            for j in range(i + 1, 5):
                if sigma[i] > sigma[j]:
                    l += 1
        return (-1)**l

    res = 0
    for sigma in permutations([0,1,2,3,4]):
        curr = 1
        for i in range(5):
            curr *= M[sigma[i]][i]
        res += sign(sigma) * curr
    return res
```

Trông có vẻ rối rắm, nhưng thực ra nó là hàm để tính định thức của ma trận bằng. Đến với hàm nữa là hàm `fun`:
```python
def fun(M):
    f = [bytes_to_long(bytes(FLAG[5*i:5*(i+1)], 'utf-8')) for i in range(5)]
    F = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]
    for i in range(5):
        F[i][i] = f[i]

    try:
        R = np.matmul(F, M)
        return np.trace(R)

    except:
        print("[WAT] You're trying too hard, try something simpler")
        return None
```

Hàm này sẽ tiến hành chia flag của chúng ta thành 5 block để cho vào đường chéo của một ma trận đường chéo khác. Sau đó tiến hành nhân ma trận này với ma trận ban đầu của chúng ta và trả về tổng các phần tử trên đường chéo của ma trận kết quả sử dụng hàm `trace` trong `numpy`.

```python
def main():
    print("[WAT] Welcome")
    M = inputs()
    if M is None:
        print("[WAT] You tried something weird...")
        return
    elif check(M) == 0:
        print("[WAT] It's not going to be that easy...")
        return

    res = fun(M)
    if res == None:
        print("[WAT] You tried something weird...")
        return
    print(f"[WAT] Have fun: {res}")
```

Chương trình trên server sẽ check xem định thức của ma trận chúng ta nhập có định thức bằng 0 không, hay là các phần tử trên đường chéo phải khác 0. Sau đó trả về giá trị của hàm `fun` như trên mình vừa nói.

Có thể thấy, ma trận chứa flag là không đổi. Thêm nữa, khi nhân 2 ma trận đường chéo, ma trận kết quả sẽ như sau:

$$ \begin{bmatrix}
a & 0 & 0 & 0 & 0 \\
0 & b & 0 & 0 & 0 \\
0 & 0 & c & 0 & 0 \\
0 & 0 & 0 & d & 0 \\
0 & 0 & 0 & 0 & e
\end{bmatrix} \begin{bmatrix}
F & 0 & 0 & 0 & 0 \\
0 & L & 0 & 0 & 0 \\
0 & 0 & A & 0 & 0 \\
0 & 0 & 0 & G & 0 \\
0 & 0 & 0 & 0 & S
\end{bmatrix} = \begin{bmatrix}
a.F & 0 & 0 & 0 & 0 \\
0 & b.L & 0 & 0 & 0 \\
0 & 0 & c.A & 0 & 0 \\
0 & 0 & 0 & d.G & 0 \\
0 & 0 & 0 & 0 & e.S
\end{bmatrix} $$ 

Tổng đường chéo của ma trận kết quả sẽ là phương trình như sau:

$$ a.F + b.L + c.A + d.G + e.S = X $$

Chương trình sẽ trả về cho chúng ta X, và các số (a, b, c, d, e) sẽ được chúng ta kiểm soát. Vì vậy, mình chỉ cần kết nối tới server 5 lần để lấy ra 5 phương trình như trên. Với 5 phương trình và 5 ẩn số, ta sẽ tính ra được từng block của flag.

Lưu ý: Sử dụng `random` cho các số (a, b, c, d, e) ở mỗi phương trình để đảm bảo hệ phương trình này có thể giải được.

### Solution:
```python
from Crypto.Util.number import *
from pwn import *
from sage.all import *
import random

result = []
matrix = []
for _ in range(5):
    arr = []
    conn = remote("without-a-trace.chal.uiuc.tf", "1337", ssl=True)

    def recvLine(n):
        for _ in range(n):
            conn.recvline()

    recvLine(2)
    for _ in range(5):
        x = random.randint(1, 25)
        arr.append(x)
        conn.sendline(str(x).encode())
        

    output = int(conn.recvline().decode().strip()[71:])
    
    matrix.append(arr)
    result.append(output)


A = Matrix(matrix)
b = vector(result)

x = A.solve_right(b)
x = list(x)

flag = b''
for i in x:
    flag += long_to_bytes(int(i))

print(flag.decode())
```
Flag: *uiuctf{tr4c1ng_&&_mult5!}*

## Determined
### Description:
"It is my experience that proofs involving matrices can be shortened by 50% if one throws the matrices out."

Emil Artin  
`ncat --ssl determined.chal.uiuc.tf 1337`

### Attachments:
*gen.py*
```python
from SECRET import FLAG, p, q, r
from Crypto.Util.number import bytes_to_long
n = p * q
e = 65535
m = bytes_to_long(FLAG)
c = pow(m, e, n)
# printed to gen.txt
print(f"{n = }")
print(f"{e = }")
print(f"{c = }")
```

*gen.txt*
```
n = 158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993839560087229636799779157903650823700424848036276986652311165197569877428810358366358203174595667453056843209344115949077094799081260298678936223331932826351
e = 65535
c = 72186625991702159773441286864850566837138114624570350089877959520356759693054091827950124758916323653021925443200239303328819702117245200182521971965172749321771266746783797202515535351816124885833031875091162736190721470393029924557370228547165074694258453101355875242872797209141366404264775972151904835111
```

*server.py*
```python
from Crypto.Util.number import bytes_to_long, long_to_bytes
from itertools import permutations
from SECRET import FLAG, p, q, r



def inputs():
    print("[DET] First things first, gimme some numbers:")
    M = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]
    try:
        M[0][0] = p
        M[0][2] = int(input("[DET] M[0][2] = "))
        M[0][4] = int(input("[DET] M[0][4] = "))

        M[1][1] = int(input("[DET] M[1][1] = "))
        M[1][3] = int(input("[DET] M[1][3] = "))

        M[2][0] = int(input("[DET] M[2][0] = "))
        M[2][2] = int(input("[DET] M[2][2] = "))
        M[2][4] = int(input("[DET] M[2][4] = "))

        M[3][1] = q
        M[3][3] = r

        M[4][0] = int(input("[DET] M[4][0] = "))
        M[4][2] = int(input("[DET] M[4][2] = "))
    except:
        return None
    return M

def handler(signum, frame):
    raise Exception("[DET] You're trying too hard, try something simpler")

def fun(M):
    def sign(sigma):
        l = 0
        for i in range(5):
            for j in range(i + 1, 5):
                if sigma[i] > sigma[j]:
                    l += 1
        return (-1)**l

    res = 0
    for sigma in permutations([0,1,2,3,4]):
        curr = 1
        for i in range(5):
            curr *= M[sigma[i]][i]
        res += sign(sigma) * curr
    return res

def main():
    print("[DET] Welcome")
    M = inputs()
    if M is None:
        print("[DET] You tried something weird...")
        return

    res = fun(M)
    print(f"[DET] Have fun: {res}")

if __name__ == "__main__":
    main()
```

### Analysis:
Bài này cũng sử dụng ma trận. Tuy nhiên có một số khác biệt, trước hết là hàm `input`:
```python
def inputs():
    print("[DET] First things first, gimme some numbers:")
    M = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]
    try:
        M[0][0] = p
        M[0][2] = int(input("[DET] M[0][2] = "))
        M[0][4] = int(input("[DET] M[0][4] = "))

        M[1][1] = int(input("[DET] M[1][1] = "))
        M[1][3] = int(input("[DET] M[1][3] = "))

        M[2][0] = int(input("[DET] M[2][0] = "))
        M[2][2] = int(input("[DET] M[2][2] = "))
        M[2][4] = int(input("[DET] M[2][4] = "))

        M[3][1] = q
        M[3][3] = r

        M[4][0] = int(input("[DET] M[4][0] = "))
        M[4][2] = int(input("[DET] M[4][2] = "))
    except:
        return None
    return M
```

Ma trận sau khi được nhập sẽ có dạng như sau:

$$ \begin{bmatrix}
p & 0 & A & 0 & B \\
0 & C & 0 & D & 0 \\
E & 0 & F & 0 & G \\
0 & q & 0 & r & 0 \\
H & 0 & I & 0 & 0
\end{bmatrix} $$

Với `p`, `q` sẽ được dùng trong file *gen.py* để mã hóa RSA. Với hàm `fun` thì các bạn sẽ nhận ra nó chính là hàm `check` của bài trước, sử dụng để tính định thức của ma trận. Đến với hàm `main`:
```python
def main():
    print("[DET] Welcome")
    M = inputs()
    if M is None:
        print("[DET] You tried something weird...")
        return

    res = fun(M)
    print(f"[DET] Have fun: {res}")
```

Hàm này sẽ chỉ cho chúng ta biết được định thức của ma trận chúng ta truyền vào. Vậy thì mục đích của chúng ta có vẻ là phải tìm ra `p`, `q` dựa vào định thức này.

Áp dụng motip từ bài trước, mình sẽ xây dựng các phương trình dựa trên định thức. Đầu tiên mình hướng tới việc xây dựng sử dụng công thức tính định thức ma trận 5x5, tuy nhiên nó khá là rối rắm và có vẻ không hợp lí để bắt đầu lắm. Nên mình đã nghĩ ra cách khác.

Mình sẽ sử dụng sagemath và coi `p, q, r` là các biến số. Từ đó mình cứ thế tính định thức của ma trận ngẫu nhiên mình input và mình sẽ ra được một phương trình chứa các biến đó. Sau khi thử thì mình ra được một phương trình dạng như sau:

$$ A.p.q - B.p.r - C.q + D.r == X $$ 

Đây là một phương trình với 4 ẩn là `p*q`, `p*r`, `q` và `r`. Vì vậy, mình chỉ cần lấy ra 4 phương trình như vậy sau đó giải ra mình sẽ có được `q`. Từ đấy có thể giải mã RSA để tìm lại flag.

### Solution:
**Warning:** Bad code

*find_equa.py*
```python
from Crypto.Util.number import *
from pwn import *
from sage.all import *
from itertools import permutations
import random

p, q, r = var('p q r')

def fun(M):
    def sign(sigma):
        l = 0
        for i in range(5):
            for j in range(i + 1, 5):
                if sigma[i] > sigma[j]:
                    l += 1
        return (-1)**l

    res = 0
    for sigma in permutations([0, 1, 2, 3, 4]):
        curr = 1
        for i in range(5):
            curr *= M[sigma[i]][i]
        res += sign(sigma) * curr
    return res

f = []

for _ in range(4):
    conn = remote("determined.chal.uiuc.tf", 1337, ssl=True)

    def recvLine(n):
        for _ in range(n):
            conn.recvline()

    recvLine(2)
    M = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ]

    M[0][0] = p
    M[0][2] = random.randint(1, 5)
    conn.sendline(str(M[0][2]).encode())
    M[0][4] = random.randint(1, 5)
    conn.sendline(str(M[0][4]).encode())

    M[1][1] = random.randint(1, 5)
    conn.sendline(str(M[1][1]).encode())
    M[1][3] = random.randint(1, 5)
    conn.sendline(str(M[1][3]).encode())

    M[2][0] = random.randint(1, 5)
    conn.sendline(str(M[2][0]).encode())
    M[2][2] = random.randint(1, 5)
    conn.sendline(str(M[2][2]).encode())
    M[2][4] = random.randint(1, 5)
    conn.sendline(str(M[2][4]).encode())

    M[3][1] = q
    M[3][3] = r

    M[4][0] = random.randint(1, 5)
    conn.sendline(str(M[4][0]).encode())
    M[4][2] = random.randint(1, 5)
    conn.sendline(str(M[4][2]).encode())

    M = Matrix(M)

    det = int(conn.recvline().decode().strip()[160:])

    eq = fun(M) == det
    f.append(eq)

print(f)

# f = [15*p*q - 20*p*r + 60*q - 80*r == 588900893792602448701057708897096305154481356720873302301485077287778209297472186060328547649285967251827419960296329830484314653732418477081958850015166260605986621602222081224841175605665853857367400269641983798302748009887448264004009002235018653553303940018542779033700944422724335620348666532306697231225, 30*p*q - 15*p*r - 244*q + 122*r == 3419075108483569138674716903101461938680068372628412307022953398294641738086048559394645962356277579214837387110376271783696110543821594265840894592236256851870663475527516579528135504911460466279971359363091220491978106416890987865687324080428163367648751299205973484466549290611499348653397661065120354467245, 8*p*q - 40*p*r == -2315680219831359403785954964682077982539707249861221996278654964743578396577577080502638378601422107260146231390521395647741943502001305391257274833513532321119483587939007837880676897647758380101552539109420325060641582882034977860448594292939826712556833345378727519925831445775713762771326528542911217029872, 48*p*q - 80*p*r - 144*q + 240*r == 450067934761374721428919717874055806336832719627328517815962971340675665277604315537698477560783482590690913671486743699004218900675414447189003109036738117068114629133728440426319950738868586735893085062535831750449207778840912072235177452838485343903069693771527020002215249955701804769001720819785024479232]
```

*get_q.sage*
```python
pq, pr, q, r = var('pq pr q r')

# replace p*q to pq and p*r to pr
f = [15*pq - 20*pr + 60*q - 80*r == 588900893792602448701057708897096305154481356720873302301485077287778209297472186060328547649285967251827419960296329830484314653732418477081958850015166260605986621602222081224841175605665853857367400269641983798302748009887448264004009002235018653553303940018542779033700944422724335620348666532306697231225, 30*pq - 15*pr - 244*q + 122*r == 3419075108483569138674716903101461938680068372628412307022953398294641738086048559394645962356277579214837387110376271783696110543821594265840894592236256851870663475527516579528135504911460466279971359363091220491978106416890987865687324080428163367648751299205973484466549290611499348653397661065120354467245, 8*pq - 40*pr == -2315680219831359403785954964682077982539707249861221996278654964743578396577577080502638378601422107260146231390521395647741943502001305391257274833513532321119483587939007837880676897647758380101552539109420325060641582882034977860448594292939826712556833345378727519925831445775713762771326528542911217029872, 48*pq - 80*pr - 144*q + 240*r == 450067934761374721428919717874055806336832719627328517815962971340675665277604315537698477560783482590690913671486743699004218900675414447189003109036738117068114629133728440426319950738868586735893085062535831750449207778840912072235177452838485343903069693771527020002215249955701804769001720819785024479232]

x = solve(f, pq, pr, q, r)
print(x)

# [pq == 158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993839560087229636799779157903650823700424848036276986652311165197569877428810358366358203174595667453056843209344115949077094799081260298678936223331932826351, pr == 89650932835934569650904059412290773134844226367466628096799329748763412779644167490959554682308225788447301887591344484909099249454270292467079075688237075940004535625835151778597652605934044472146068875065970359555553547536636518184486497958414801304532202276337011187961205104209096129018950458239166991017, q == 12538849920148192679761652092105069246209474199128389797086660026385076472391166777813291228233723977872612370392782047693930516418386543325438897742835129, r == 7079077828991557904453386075761691430024858841559152638771101891403817504002722603786046116429444882212741713778792076162641378721868400698674834419068143]
```

*solve.py*
```python
from Crypto.Util.number import *

n = 158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993839560087229636799779157903650823700424848036276986652311165197569877428810358366358203174595667453056843209344115949077094799081260298678936223331932826351
e = 65535
c = 72186625991702159773441286864850566837138114624570350089877959520356759693054091827950124758916323653021925443200239303328819702117245200182521971965172749321771266746783797202515535351816124885833031875091162736190721470393029924557370228547165074694258453101355875242872797209141366404264775972151904835111

q = 12538849920148192679761652092105069246209474199128389797086660026385076472391166777813291228233723977872612370392782047693930516418386543325438897742835129
p = n // q
d = inverse(e, (p-1)*(q-1))

print(long_to_bytes(pow(c, d, n)))
```
Flag: *uiuctf{h4rd_w0rk_&&_d3t3rm1n4t10n}*

## Naptime
### Description:
I'm pretty tired. Don't leak my flag while I'm asleep.

### Attachments:
*enc_dist.sage*
```python
from random import randint
from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes
import numpy as np

def get_b(n):
    b = []
    b.append(randint(2**(n-1), 2**n))
    for i in range(n - 1):
        lb = sum(b)
        found = False
        while not found:
            num = randint(max(2**(n + i), lb + 1), 2**(n + i + 1))
            if num > lb:
                found = True
                b.append(num)

    return b

def get_MW(b):
    lb = sum(b)
    M = randint(lb + 1, 2*lb)
    W = getPrime(int(1.5*len(b)))

    return M, W

def get_a(b, M, W):
    a_ = []
    for num in b:
        a_.append(num * W % M)
    pi = np.random.permutation(list(i for i in range(len(b)))).tolist()
    a = [a_[pi[i]] for i in range(len(b))]
    return a, pi


def enc(flag, a, n):
    bitstrings = []
    for c in flag:
        # c -> int -> 8-bit binary string
        bitstrings.append(bin(ord(c))[2:].zfill(8))
    ct = []
    for bits in bitstrings:
        curr = 0
        for i, b in enumerate(bits):
            if b == "1":
                curr += a[i]
        ct.append(curr)

    return ct

def dec(ct, a, b, pi, M, W, n):
    # construct inverse permuation to pi
    pii = np.argsort(pi).tolist()
    m = ""
    U = pow(W, -1, M)
    ct = [c * U % M for c in ct]
    for c in ct:
        # find b_pi(j)
        diff = 0
        bits = ["0" for _ in range(n)]
        for i in reversed(range(n)):
            if c - diff > sum(b[:i]):
                diff += b[i]
                bits[pii[i]] = "1"
        # convert bits to character
        m += chr(int("".join(bits), base=2))

    return m


def main():
    flag = 'uiuctf{I_DID_NOT_LEAVE_THE_FLAG_THIS_TIME}'

    # generate cryptosystem
    n = 8
    b = get_b(n)
    M, W = get_MW(b)
    a, pi = get_a(b, M, W)

    # encrypt
    ct = enc(flag, a, n)

    # public information
    print(f"{a =  }")
    print(f"{ct = }")

    # decrypt
    res = dec(ct, a, b, pi, M, W, n)

if __name__ == "__main__":
    main()
```

*pub.txt*
```python
a =  [66128, 61158, 36912, 65196, 15611, 45292, 84119, 65338]
ct = [273896, 179019, 273896, 247527, 208558, 227481, 328334, 179019, 336714, 292819, 102108, 208558, 336714, 312723, 158973, 208700, 208700, 163266, 244215, 336714, 312723, 102108, 336714, 142107, 336714, 167446, 251565, 227481, 296857, 336714, 208558, 113681, 251565, 336714, 227481, 158973, 147400, 292819, 289507]
```

### Analysis:
Bài này thì là một bài về hệ mã **Merkle – Hellman** điển hình, liên quan tới bài toán **Knapsack**. Mọi thông tin cần thiết có thể đọc ở đây: [Link](https://drx.home.blog/2019/02/24/crypto-he-ma-merkle-hellman/) (Cảm ơn tác giả vì viết khá chi tiết)

Dựa trên bài viết trên thì ta đã được cho sẵn mảng `a` chính là public key $T$ và một mảng `ct` chứa các $C$ là từng kí tự của flag bị mã hóa. Áp dụng như bài viết và sử dụng `liblll`, mình sẽ giải được bài này.

### Solution:
```python
# https://github.com/kutio/liblll
import liblll

# Public Key
T =  [66128, 61158, 36912, 65196, 15611, 45292, 84119, 65338]

# Ciphertext
ct = [273896, 179019, 273896, 247527, 208558, 227481, 328334, 179019, 336714, 292819, 102108, 208558, 336714, 312723, 158973, 208700, 208700, 163266, 244215, 336714, 312723, 102108, 336714, 142107, 336714, 167446, 251565, 227481, 296857, 336714, 208558, 113681, 251565, 336714, 227481, 158973, 147400, 292819, 289507]

# LLL Algorithm
flag = ""
for C in ct:
    M = liblll.create_matrix_from_knapsack(T, C)
    M_reduced = liblll.lll_reduction(M)
    U = liblll.best_vect_knapsack(M_reduced)

    assert liblll.scalar_product(T, U) == C

    U = "".join(map(str, U))
    flag += chr(int(U, 2))

print(flag)
```
Flag: *uiuctf{i_g0t_sleepy_s0_I_13f7_th3_fl4g}*

## Snore Signatures
### Description:
These signatures are a bore!

`ncat --ssl snore-signatures.chal.uiuc.tf 1337`

### Attachment:
*chal.py*
```python
#!/usr/bin/env python3

from Crypto.Util.number import isPrime, getPrime, long_to_bytes, bytes_to_long
from Crypto.Random.random import getrandbits, randint
from Crypto.Hash import SHA512

LOOP_LIMIT = 2000


def hash(val, bits=1024):
    output = 0
    for i in range((bits//512) + 1):
        h = SHA512.new()
        h.update(long_to_bytes(val) + long_to_bytes(i))
        output = int(h.hexdigest(), 16) << (512 * i) ^ output
    return output


def gen_snore_group(N=512):
    q = getPrime(N)
    for _ in range(LOOP_LIMIT):
        X = getrandbits(2*N)
        p = X - X % (2 * q) + 1
        if isPrime(p):
            break
    else:
        raise Exception("Failed to generate group")

    r = (p - 1) // q

    for _ in range(LOOP_LIMIT):
        h = randint(2, p - 1)
        if pow(h, r, p) != 1:
            break
    else:
        raise Exception("Failed to generate group")

    g = pow(h, r, p)

    return (p, q, g)


def snore_gen(p, q, g, N=512):
    x = randint(1, q - 1)
    y = pow(g, -x, p)
    return (x, y)


def snore_sign(p, q, g, x, m):
    k = randint(1, q - 1)
    r = pow(g, k, p)
    e = hash((r + m) % p) % q
    s = (k + x * e) % q
    return (s, e)


def snore_verify(p, q, g, y, m, s, e):
    if not (0 < s < q):
        return False

    rv = (pow(g, s, p) * pow(y, e, p)) % p
    ev = hash((rv + m) % p) % q

    return ev == e


def main():
    p, q, g = gen_snore_group()
    print(f"p = {p}")
    print(f"q = {q}")
    print(f"g = {g}")

    queries = []
    for _ in range(10):
        x, y = snore_gen(p, q, g)
        print(f"y = {y}")

        print('you get one query to the oracle')

        m = int(input("m = "))
        queries.append(m)
        s, e = snore_sign(p, q, g, x, m)
        print(f"s = {s}")
        print(f"e = {e}")

        print('can you forge a signature?')
        m = int(input("m = "))
        s = int(input("s = "))
        # you can't change e >:)
        if m in queries:
            print('nope')
            return
        if not snore_verify(p, q, g, y, m, s, e):
            print('invalid signature!')
            return
        queries.append(m)
        print('correct signature!')

    print('you win!')
    print(open('flag.txt').read())

if __name__ == "__main__":
    main()
```

### Analysis:
> Bằng cách nào đó, bài này mình lại nghĩ ra nhanh nhất :v

Với bài này, ta sẽ có một hệ thống ký số. Nhìn qua các hàm băm và tạo tham số mình thấy khá lằng nhằng và khó dịch ngược nên mình đã nhìn hàm `main` để xem cần làm gì trước.
```python
def main():
    p, q, g = gen_snore_group()
    print(f"p = {p}")
    print(f"q = {q}")
    print(f"g = {g}")

    queries = []
    for _ in range(10):
        x, y = snore_gen(p, q, g)
        print(f"y = {y}")

        print('you get one query to the oracle')

        m = int(input("m = "))
        queries.append(m)
        s, e = snore_sign(p, q, g, x, m)
        print(f"s = {s}")
        print(f"e = {e}")

        print('can you forge a signature?')
        m = int(input("m = "))
        s = int(input("s = "))
        # you can't change e >:)
        if m in queries:
            print('nope')
            return
        if not snore_verify(p, q, g, y, m, s, e):
            print('invalid signature!')
            return
        queries.append(m)
        print('correct signature!')

    print('you win!')
    print(open('flag.txt').read())
```

Sẽ có các tham số `p`, `q`, `g` và `y` (sau nếu đọc các bạn sẽ biết `y` là public key, cơ mà không quan trọng lắm) sẽ được in ra cho chúng ta. Sau đó, chương trình sẽ yêu cầu người dùng nhập vào một thông điệp `m` và trả về chữ ký `(s, e)`. Tiếp theo, chương trình sẽ yêu cầu chúng ta nhập một thông điệm `m'` khác `m` với `s` tùy ý. Nếu nó bypass được quá trình kiểm tra chữ ký số 10 lần thì sẽ in ra flag.

Theo logic thì chỉ message được kí thì mới có thể được verify thành công, nên mình nghĩ vuln sẽ nằm trong hàm verify. Kiểm tra hàm đó, ta có như sau:
```python
def snore_verify(p, q, g, y, m, s, e):
    if not (0 < s < q):
        return False

    rv = (pow(g, s, p) * pow(y, e, p)) % p
    ev = hash((rv + m) % p) % q

    return ev == e
```
Ta có thể thấy, hàm nãy sẽ trả về True nếu `ev == e`. Giá trị `ev` được tính bằng `hash((rv + m) % p) % q`, với `rv = (pow(g, s, p) * pow(y, e, p)) % p`.

Do `rv` chứa `s` là ta thao túng được và không chứa `m`, nên nếu ta giữ nguyên `s`, `rv` sẽ đúng như lúc ta input `m`. Khi này, nhiệm vụ của ta chỉ là tìm `m'` sao cho `hash((rv + m') % p) % q` == `hash((rv + m) % p) % q`. Điều này sẽ tương đương:

$$ rv + m' \equiv rv + m \pmod{p} $$
$$ \Leftrightarrow m' \equiv m \pmod{p} $$
$$ \Leftrightarrow m' = m + kp, \quad \forall k \in \mathbb{Z}  $$

Do `p` là đã biết, ta dễ dàng tính được `m'` sử dụng công thức trên với `k` bằng 2 chả hạn, sau đó gửi đi cùng với `s` giống với `s` của `m`. Khi đó, ta sẽ bypass được hệ thống verify.

Lặp lại điều trên 10 lần với các cặp `(m, m')` khác nhau (do không được gửi thông điệp cũ), ta sẽ lấy được flag.

### Solution:
```python
from pwn import *

conn = remote("snore-signatures.chal.uiuc.tf", 1337, ssl=True)

def recvLine(n):
    for _ in range(n):
        print(conn.recvline())

p = int(conn.recvline().decode().strip()[4:])
recvLine(4)

for i in range(10):  
    conn.sendline(str(i).encode())
    s = int(conn.recvline().decode().strip()[8:])
    recvLine(2)

    conn.sendline(str(i+p).encode())
    conn.sendline(str(s).encode())

    recvLine(3)
```
Flag: *uiuctf{add1ti0n_i5_n0t_c0nc4t3n4ti0n}*

## Groups
### Description:
My friend told me that cryptography is unbreakable if moduli are Carmichael numbers instead of primes. I decided to use this CTF to test out this theory.

`ncat --ssl groups.chal.uiuc.tf 1337`

### Attachment:
*challenge.py*
```python
from random import randint
from math import gcd, log
import time
from Crypto.Util.number import *


def check(n, iterations=50):
    if isPrime(n):
        return False

    i = 0
    while i < iterations:
        a = randint(2, n - 1)
        if gcd(a, n) == 1:
            i += 1
            if pow(a, n - 1, n) != 1:
                return False
    return True


def generate_challenge(c):
    a = randint(2, c - 1)
    while gcd(a, c) != 1:
        a = randint(2, c - 1)
    k = randint(2, c - 1)
    return (a, pow(a, k, c))


def get_flag():
    with open('flag.txt', 'r') as f:
        return f.read()

if __name__ == '__main__':
    c = int(input('c = '))

    if log(c, 2) < 512:
        print(f'c must be least 512 bits large.')
    elif not check(c):
        print(f'No cheating!')
    else:
        a, b = generate_challenge(c)
        print(f'a = {a}')
        print(f'a^k = {b} (mod c)')
        
        k = int(input('k = '))

        if pow(a, k, c) == b:
            print(get_flag())
        else:
            print('Wrong k')
```

### Analysis:
Ở bài này, ban đầu ta có hàm `check`:
```python
def check(n, iterations=50):
    if isPrime(n):
        return False

    i = 0
    while i < iterations:
        a = randint(2, n - 1)
        if gcd(a, n) == 1:
            i += 1
            if pow(a, n - 1, n) != 1:
                return False
    return True
```
Hàm này sử dụng để kiểm tra xem 1 số có phải là **Carmichael numbers** hay không. Số này là một hợp số $n$ thỏa mãn, với mọi số $b$ nguyên, ta sẽ có:

$$ b^n \equiv b \pmod{n} \\ or \\ b^{n-1} \equiv 1 \pmod{n}$$

Tiếp theo là hàm tạo thử thách:
```python
def generate_challenge(c):
    a = randint(2, c - 1)
    while gcd(a, c) != 1:
        a = randint(2, c - 1)
    k = randint(2, c - 1)
    return (a, pow(a, k, c))
```

Hàm này sẽ tạo ra một số `a` ngẫu nhiên trong khoảng (2, c-1) với `c` là số thỏa mãn hàm check trước và `a` và `c` sẽ nguyên tố cùng nhau. Hàm này trả về `a` và `a^k (mod c)` với `k` cũng là số ngẫu nhiên trong khoảng (2, c-1).

Đến với hàm `main`:
```python
if __name__ == '__main__':
    c = int(input('c = '))

    if log(c, 2) < 512:
        print(f'c must be least 512 bits large.')
    elif not check(c):
        print(f'No cheating!')
    else:
        a, b = generate_challenge(c)
        print(f'a = {a}')
        print(f'a^k = {b} (mod c)')
        
        k = int(input('k = '))

        if pow(a, k, c) == b:
            print(get_flag())
        else:
            print('Wrong k')
```

Hàm này sẽ cho chúng ta điền vào một số `c`. Nếu độ dài không nhỏ hơn 512-bit và thỏa mãn hàm `check` thì sẽ in ra `a` và `a^k (mod c)`. Yêu cầu của chương trình là bắt chúng ta tính lại `k`, nếu đúng sẽ có được flag.

Về việc tính `k` trong `a^k (mod c)` thì đó là bài toán **Discrete Log** điển hình. Do ta có thể thao túng `c`, ta phải tìm ra một số `c` có thể dễ dàng factor. Nếu là một bài toán bình thường thì ta chỉ cần tìm một **Smooth Prime** và sử dụng **Pohlig-Hellman**. Tuy nhiên do đây không phải số nguyên tố mà phải là hợp số, nên mình đã phải tra cứu một xíu.

Mình đã tìm ra một số thỏa mãn được gen ra trong bài viết này: [Link](https://mslc.ctf.su/wp/tum-ctf-2016-tacos-crypto-300/)

Sử dụng số `c` lấy được, mình có thể dễ dàng giải bài toán này và lấy được flag.

### Solution:
```python
from sage.all import *
from pwn import *

conn = remote("groups.chal.uiuc.tf", 1337, ssl=True)

c = 59857999685097510058704903303340275550835640940514904342609260821117098340506319476802302889863926430165796687108736694628663794024203081690831548926936527743286188479060985861546093711311571900661759884274719541236402441770905441176260283697893506556009435089259190308034118717196693029323272007089714272903225216389846915864612112381878100108428287917605430965442572234711074146363466926780699151173555904751392997928289187479977403795442182731620805949932616667193358004913424246140299423521
conn.sendline(str(c).encode())

a = int(conn.recvline().decode().strip()[8:])
y = int(conn.recvline().decode().strip()[6:-8])

R = IntegerModRing(c)
x = discrete_log(R(y), R(a))

conn.sendline(str(x).encode())

flag = conn.recvline().decode().strip()[4:]
print(flag)
```
Flag: *uiuctf{c4rm1ch43l_7adb8e2f019bb4e0e8cd54e92bb6e3893}*

## Key in a Haystack
### Description:
I encrpyted the flag, but I lost my key in an annoyingly large haystack. Can you help me find it and decrypt the flag?

`ncat --ssl key-in-a-haystack.chal.uiuc.tf 1337`

### Attachment:
*chal.py*
```python
from Crypto.Util.number import getPrime
from Crypto.Util.Padding import pad
from Crypto.Cipher import AES

from hashlib import md5
from math import prod
import sys

from secret import flag

key = getPrime(40)
haystack = [ getPrime(1024) for _ in range(300) ]
key_in_haystack = key * prod(haystack)

enc_flag = AES.new(
	key = md5(b"%d" % key).digest(),
	mode = AES.MODE_ECB
).encrypt(pad(flag, 16))

sys.set_int_max_str_digits(0)

print(f"enc_flag: {enc_flag.hex()}")
print(f"haystack: {key_in_haystack}")

exit(0)
```

### Analysis:
Ở bài này, flag được mã hóa sử dụng AES_ECB, với key là một số nguyên tố 40-bits. Cũng khá lớn để có thể bruteforce trong thời gian ctf diễn ra (2 ngày).

Tuy không biết key, nhưng ta được cho giá trị của một biến là `key_in_haystack`, được tính như sau:
```python
haystack = [ getPrime(1024) for _ in range(300) ]
key_in_haystack = key * prod(haystack)
```

Biến này chứa tích của 300 số nguyên tố 1024-bits cùng với đó là `key`. Nhìn vào các dòng code còn lại, có vẻ ta chỉ có thể tính được `key` dựa vào giá trị này. Do là tích của tận 300 số nguyên tố 1024-bits, giá trị này là vô cùng lớn (dài hơn 92000 kí tự). Việc factor được giá trị này dường như là không thể.

Tuy nhiên, `key` của chúng ta là thừa số nguyên tố có giá trị rất nhỏ trong số này (chỉ 40-bits). Có một thuật toán factor có thể giúp chúng ta lấy ra dần được các thừa số nhỏ như này trong quá trình factor là **ECM**, không cần phải fully-factor. Điều này là khả thi.

Sử dụng **ECM-GMP**, mình lấy được ra giá trị này trong một khoảng thời gian phải gọi là, khá nhanh. Có thể sẽ mất vài lần để ra được kết quả. Chắc ăn hơn thì nên tăng bound1 lên khoảng 10000, đương nhiên là nó sẽ lâu hơn chút. 

```bash
pr0pylth10ur4c1l@Pr0pylTh10ur4C1L:~/$ cat large_number.txt | ecm -v 1000
GMP-ECM 7.0.4 [configured with GMP 6.2.1, --enable-asm-redc] [ECM]
Tuned for x86_64/k8/params.h
Running on Pr0pylTh10ur4C1L
Input number is 1464115201...8032534901 (92472 digits)
Using REDC
Using B1=1000, B2=69876, polynomial x^1, sigma=0:4813681212692683993
dF=64, k=2, d=510, d2=7, i0=-5
Expected number of curves to find a factor of n digits:
35      40      45      50      55      60      65      70      75      80
5.2e+10 Inf     Inf     Inf     Inf     Inf     Inf     Inf     Inf     Inf
Step 1 took 38762ms
Estimated memory usage: 103.17MB
Initializing tables of differences for F took 478ms
Computing roots of F took 1406ms
Building F from its roots took 2264ms
Computing 1/F took 970ms
Initializing table of differences for G took 1267ms
Computing roots of G took 1355ms
Building G from its roots took 2023ms
Computing roots of G took 1547ms
Building G from its roots took 1880ms
Computing G * H took 661ms
Reducing  G * H mod F took 882ms
Computing polyeval(F,G) took 2718ms
Computing product of all F(g_i) took 201ms
Step 2 took 17670ms
********** Factor found in step 2: 747655810723
```

Có được giá trị này, mọi chuyện sẽ chả còn gì nữa, chỉ cần giải mã AES_ECB với `key` thu được, ta sẽ có được flag.

### Solution:
Do bài này bị ai đó ddos server bằng cách nào đó, nên nó đã phải thêm cơ chế xác minh trước khi lấy output nên mình không viết pwntools được. Output của server mình thu được bằng tay là:
```
enc_flag: e3c690b3918222d68f0871f51cabc0b2faeb5ee29b1ad53e440f07ab37e4c75d21e3db59ac35cae4672968b6fdd1c2bb
haystack: 146411520117601951066826624011144648629207861054851032385350663419146531785241301007066877403304286702316375538576036008361771178589607109946795716986647465617552834405344753254169173031121280287916702576580862783564945897612699282535449037827837094487364292231613544414451740161970099515370236123202484131316157753061174622845896259822592702689620679102674798640709263209067479194536617446247859711646002601712097821231189103811508660035071368865435251101091466549547924451599122615364216615117631295107898266958489769482883194565813700792954558025164832594457249707339532522766074713501840781525176405541861579596061976451772696561775898752112214465197810652493999205288145425118922310253874383907839749542249203751051626085358814266384842284117104248459784134387837206164615022980584999747562835416873259487637915394768856812013054785352916642616773454256284114340110284565725716597127297911710556785370819319618121122321623350386574736234551265241824942802397115921442966141985810633510929410542456391900007734792772822983652284946940082914067530853447139831073591106828484777282168209733210357175262416505655519050904809657070569754957449305192144781233159645797946155564497463609186093312117990920700296302664296190848225628630338056351197922703738998330266548712018898447199093911292405690239777772162581162321954288734169525122675424935812097343489242469399341231717065980450642606430572473803779711739274458222694593118875197345615224989744634097555289497528324300799426831586047040921502935740092959653363428034509410065572036449935189036485442979618023916911525410775992764839819167566847461448817004433462185929014537873718038956770890749482218773201249863551197959115597942728903713331102611698338685313812601922428675318985849205786578402222021823988174717846427255161947099136645885274748633922709067114252186263643815820056938039956418623783241070738255953202413476011934561050662024159336523413827051319627111544491421945820912772089776706666528998822850285598368023715091328226465354876805514402141371817916551673720548687211185397493614552549300807359432137234497462175946803613440320385625135331942173222573357596920246049411935212565273744904426142508054550796624730105073882661976221062114411642772740361825679925198927681901912660369533908661534179721931953497062269947513650263656670450769031101831929214900527551183225996418774325475897391941264674303626068867580195705243066626084567263584133861919450798667737480228011954073673777881532986772376982562534841850416657722115995975121097034210060902306550096524503088650287885511441266965699969301768527583797696687780661455798763784748739351695636440726882821600092085448454164159899887699100374400070943035328872131156338337045443104903355874712165387648085273938719565439979708786648749784643538045626145781254960921830672840990204542620185748107086459781061115252149807246692598125413398341601126039012887701820194352839056578956779787006002873023530807833441720836517943460054269482126429755971426429802219111209618420522275198679094733290729204767419403504244881407364675319905199794740221491025378783810343114886688822455109224503430194942100406469302326816045066336653746340387173388649804918137185767710370138168419098920349604627515768004976648478137005007557425414494698575315402944663076197909807314394965452643978950417514403837369246827568505129818048038249742458272208490792297447116048992751772919442808173085856004702196853410517992138949357535639365492540831802301193988314194553348137650802985915191255350136647673579615548893681503500831571500639044380907446961587541311080125584253328015650504702496252930910396977079675796632621844099273473481038213547677160672196845763537465650667499744067453250495260918248487373410306343778328355735574292321381518059408418833971765500746262253146834942601940497975261321820588091292309869771146432732285127667781157655894117773937395451337877927669123781743981378091706628553285697337215874170812781256721310228552893583996387769575642697964678097554683846947162047998821773170350121600370930405787880559088539763864627316969331054704794027315641847300690851064565738898043656819609169654429818123304947396743494251600079844927751030720130688332131124590040583413991838807496323468499810891629626549432061274053735183794102636210421403125925358520643830194060118045814468510608900005929047039336281926399792171974048045622553598981470091001393107683958266493895541538423778840714398713789221221795107081459400119034026091963929751319082492919840146711253055886978860678732637795891928143252955558484502083982216025822007758429461585189067565778922083336265178224454670862262091562913485740962726802020577223118938579722649278888422870713445083701799954644095100635894926381892499775583037749898574010824648424876783042338846411915916889719016049316986227077525661296862619252360033785016885326304805103369436166313259718649456370964591021075521453621800061823401480592341869514858812982239463729999979270149736147323101883671484983975660714882097304438752678530906739305461573186881451629824447493541654889705860691798696523342505935509549100720663737926859548512032322368322442390003262790149109923623297930194083710135560243865290708025746612723898579008696667969236797043739431152162170327438637126162550567871817398738911225739157818721054415379094276460383768767974216770245617052991305069476225627949393602368314790104865788700286291296134091540961167636895678995262515891119373319806800244894859460627057243391289357506546178676682871525088124701278271994967699641498534512991880217612553244572748448288813301456417157602523086407139853269196351357108371036725956793059798331508549794026887904512705333130784140827818904441326450912204606347727369870947531581285005019380814129623048593980435800108402962529077635153637233637447305425044323869723647700972665668377121212258811706890727230026333865809050251725288174356024675907920970980825817845698057245952786468728482066874024607273646878500660888698334416456316982832614795478464896615890213754941852502199873692989266501403378786081405092340760295933027287837534226071128520238167648350844479586331702076515022747356570559273126857991314665426205327383502551065357616864121721940479406654803649379102752020693374581461635240400007624320445658073890264050212849026778371491616537543438084824769959360915749079388019988010728540599188800813515460135784927547468419805257241494541152798215511012926183750241448632286456860999603748704343224321524742163160982589899800588953524135044070209997390339089362483000802104099164411114961638502466152036057950227903921440102757770220853205142675243900405117326087171759716562247475662703079564508076376232169185923296221800037483158610576270579792787378303561551056817327590339219056289080566950790253967831700662524966358460740611789737874830032065674110054585335474760422126724525056352969728200850817907019976453534695079197066473987658801441815596913047860592998225651342356427514403575877666455475429256919651452197650432354302724308793007071874768313833645214810345476906700671473092593211778282958041788267418425461841269213277974117023418842976441361379472546508181297584414718059925628096719200716999775201596093754592717427511385276681946330887845924775577903112959555432800198846277125422664599114438045117915553244194725940439243858392718812206170236825031178200361146471393098493099377452395150853177338398902856191330377752266465675141283126582159690715529254737877783440898095426901211235482569510707620652587710652740495159091358732889671964402485430910780309071823863470282554001191063656881429405188269895396245475640492810999606851560173430930374926794861168663214975827494538859912501018461710516059323981752147310558731800495830420758042220753386867776973780201744401896348240582793371430775838933453653332915800939081303807944375876127737600757299088946662108449608963516653195525950876025245799472104286377665313476153177468960966580143039061394200877166807807209196448131787799359710594256115954253620983815913386928295624838043687194996780531927022734397027732712023830166565036558319998101397552178775006368515734564889292827609054577342053304920314558812322056648755066003965360490734959366837681824707320043056686961328023196175938785422770379237628783187331897799500364821634323578231820854736201944455359039759718057057002857297625203202158693200150063276764741468480053059854219901363111503364829635601000474024160797923212048850809931705032548988752866429395411582028911899485188753922158342405874648898135043964563441520443120928049662077439799111928880468530412831440729447039891855872665585602429267275763932705126220902239585835648673659129684868239518215168807505206125405674886794438893403539011285930957699742288115225958488855025845349801974869932808484508926667950669476794877116322005267296336745500005902556103807178180204159118815829215564123978808868688895592320356785592667194889051754967953227699300828867372115096252311272501734344175579380167639431307275281845586203936997374688200500935799400494842922658186282905528169670089657570433358611319763760307820189738156327118836066971658113389551215300791603211470641246184275519308000220496552184465388811370257058628530807823051471143128945922591967675261458374884170330992008284013670980478123990499480166654387354982982033123377687065079261587231068862780380127758397876796922759889700252145286057926155563276845675828779362565318266462051505560957344046835827042316096084689142302221116423515058772598838541253935448417763248751372607229292678580970951108964390554046992342440790652515324721021729715812531586028214248270116675413559704716264682435730302321833643023715340743166370299365308358906317001467984932540660255393984864968659141295582226681248487367835782640063468612720778040521249949363793498674683088594450332136973006017483809624752820410248213033833350006833485934911585664774539358072315220721504751554244871704709400088574788219750051570608243684491485881718221288698519687993238403852840890590423576128521291310041281400393255973217074575725490455164882055586731980521043340113981318861264730708257113604382248551517304210734812756110063858896073425933930464364892108331712621138611206423173988462714409166554033084166399590315149362640066757454219134368747493091661517132740102308638625430477725560467448534997659590708405314320098283880766648258454274177564437849868440709169745651148484331630939845164766267578117793028369465775928567259283258253553035993749616144797421568916270022229565818807591868449145339569826781249999433330632736312534569439666996850691867348412034303913531719684099191010270912179456182183074323081295532660248370611459917171813737744954768729243334951258918602845372647932208344181865501902555312486489480120506829747406796005602627687554928291094777694571964568696957024425248251670030468626411498710997529859130486860909571066451441667108817210202670006036817116191121759149473787621631906467712523664880410046195379515111703697482471990205798452891445826538746217953333287281589222584181639260076261139481396172032274990014760440725224029968732873915615624704028134861748026364609181287366450054003312397609321910968482328571062791209648915283389693108553882468660903894490892759634002184939526331384023418489871132846196550849648271716030354894850332465037833722234211772741274046098361698658319410166965061943956510001884396654050237599896976672403449763914353525929408040764621112032459186024947410384544405251471575975756705174951744156908810217297157635206183438456992431279190972659058035337201482599169885204280928708391521420224283113923981970352188925588969906309534631365656248689412889695876912916748908546946271211429917458957597179747790735434231858185719486192277966663050863413345329093806763174108320470960790641667730621389013901781043513323277400254287195548947133652247152606578963571996737326993950970388955038748916975573149813249119631411173833400162647943882857545547006176838348597939533967797742553959183757247055063191432393375425628181995464226741343220021897096303051851657957129535008326817517575583056756888689879764026696491974306899068700872323810521389774403624521031509444392438717746005741961037923120363098650073386038411030460760387655480374709909113063400759940305059653167495080517802756852914538550744100536302080153186560403281456932318851238511853718352740917024957625198950558982334524816093834474799268784782681804955918592453831803495325280033895224001059610384440756829745928665640381088045923587368009346917629319266827240599842997371234009579239766699180094909553931210339565281267899312323230147979349366316570946423948355330950059038872562030869616440203501393851787016762806773073005994999546386368882913323495835755172591178883161692737008530854001775229672143249755646793338413389147221027621236680655302829302106003567368516684911736911824609267100694049078332459500105669121376754761295254224046535778527460045995198355182016413254269947873039648082111466668797147685899788857028045509024051641561410640580866327905406303637165446721817277410424319212091842378315083990328275201989734086556234421063340525432579195800553018176435850092490162968050648232844600135395982305049389229339274156466541225521778989170391967951620296419268068131328152287012587351374898209182738724636792251164472035990158663231883498668253060954200492254836068444744117486988292886985628935271230776415499618121649034847918647293332510265735852044300544943372934369166534506972356069422487929699959260735628287274099746393968168711963457401916600723867437075036892095073617458384634531312869768400001623004766578940041287452774012284915565631802025904814113030505149784859491367960086127040781706906592429374241187966617675205003235668228411294039068351603133462570435110394282084703476380957990101068663129472678374231033594177842973200059841152990658787987163682891857861047527538880771512709547131115475267597095099293538207769163987001329546601233394577390665294201249204663076820965486566142981357126774219711735935002188799078505805998069870099083073578268655734427769113586800599284493170627027098109432893958166234652131315194195497185991545488844098739061958438717571545123684085543094195679452878362641188313420125305657822758434638069809946996759521908989200953632335575929708886078178943956603940811702167234256050264099750543175383207228939776832759849308937386536852446702300095098731679728881515569019133027140114471513354860113549526331584758320116184661979006158049187554791717585051768477841947701089623154241981401246611410206019932565267748650606937913180352448170449242553162333165101925896017243563622278084624762601168739779066469405738515229098823617331004565232117710829061810164141402951939063756012155430224240846434598339309084565903108677645469334594877518129433490606747080903758297488091093191408914906228276336025072582897058248298370025359491788441052184085355266850824657287497404806022549846421273449304165685052210645034571748407536995296547871329318667386994241786818226316052749054248687283680748589215971122964252132238795378984989968773639968271491910241215601388207293550398442696599557166678425256894283556732546743561653379686525126658454122036882055794550363281140265925262119902335679618041485908307429472195010018812471122700671736337252783656182302344845629043580758792130333816588198587941333751669525158729885183577659557368324267718700874518083478502103497006990559763926710290301990130088291763769755887088429362112136058419409953743420754040651575125826711684573182276015962531686765163278132363632021181382822564128885403756795761605185099294342305288372439070818236500714992572096919516752534954405608074276018441603083772781368131744607531180728198359463563220587203038761612496593511574548717882392026449540052381003772126286164156299888642628772161774383181206304681130245795431823384981109252188597493080614745088117493838644912313212797553559529384828292261166546860185347591995725992044333534518424780536419491341692293360336448358626297079563693629028118898698354364705339812059422588497723303877903559475242622134351893495493370522779074118251039980704604711883353635110698309312233983555430376208912878909925198232436215995799693719644692132820576917571402808145178522127569057667346484650659612999193941314996958845784799779502154575379650358146515121167707048525161172879572662673046229254108211571112189765764316759752286938486013632286536013509083440796322732222202833294955504305926333769469210843835698789308412000615857299160162257784449611102838273737218629488661989148291946970955583321582896333006690899867371859507793065364547283310770610516944311994349128578532532320032497532801928736877668280524186778599626124967913714345401696598468784149088854285403048500455869247434657784373897805302723965443631970094810709262638275701196930933220985210086153299036062708532456564407583358896510399341585558788025562161761777458328226293652606711742693007355975860003242144104639593631963756605747952569425222565870341194592438990801210904020856975988266433733949366730538520318415777105163139972559755020962120381827219119761949590970970489574360398496992708560766467301761143404195856166540786471479826386504536988234725234445821322948936479069119835560899566464785571560752186546527341766218891526961783916544206126197514935897308844802386583214634470333900821581076370614634263829691413311806893633664790075169509877301503713657074366964085974215777924504158929544373359990540379041102960738136678209685052783340118746553078612141910191998076670856603207177830786016659506813510711023080223281140245674626589631234933035237354936012415905848753902984587665978344803217041676192820960470444395490577826218642533734682578417584103332807722034174288057462249443047982089581518721560638015686363376743876124898839334916612199969444965632067385941563891012787018339112920116707991814445026164952245789023695773537901001915600359649785058736497763708419385017420796413496693365360162477012073102957342657717207565565325980776272020920138183162882952188325775574440011403849240355377043377248121940097087691228710547630363973742498401459106792104112587899932502138623380631553310376145760661504476057685769664471464389638030759233510976824155035580083302576757545604665426014726550742473662436161321275700884576220317798681271842031406625819419614927460467822302865974965626536000160352003713968424565427535537370917379822373587175509045058408498692448670624306181124220948873507099990731197311216703869835617460364235756012195375134118658401147615502645921540112980131060934011581483906572118275492053773466108881319058248183369703523684314087387960767744640350827857366854097284800118836981614404973413029510930224183569924027661823462486021507964792079192912326739850583661170958741663722493928934237526680729654361326528779102702844125921341268947377402339349340455856047459247070713835657337746447500307155479263236901623048800033835154287784242778920630498261245570388995434737533723080235376577280494724682433384778283631100710376251883070498843547339697984910956842876192150807576273355731372348669895214417746051766774406346144214690387085001239559720464232571651509949307047830822627860458134333755667047035081694692978638542634944271900707313588671755817582627697772088354234066737438523249493640494744779622344442700739564640191002501219196185678886895349274349305745744765333026408262688385967872013305662707035519936071275148866949747522057701747908903159926299090124613095171254505699626594375018501099174953512097864177274195990310362440615085326809923940770742903554837340756500650857596966688309446082469119708379763094117402457737165612065774217141490510751479906631272953556423530309642930987083005446830144292797169726865560271948162275167618606794359529035227062669319877606988286618607405160768740313460554082359898956097258074572304273212678884521295267117381665717865600625858318948777038453049647563429469659063580506287337479850210135458936578444771938225661805251400988115418702050925844181742430796926598046349715169880032059501773146587808608792435253178689692213048412131794635944763309679470081964414660345372218976388222005357831780655236827058824862298394267360616908384989365272310070490913975622311480675181957971697396209417681538936200803922943165026136008498572783271749171199123123065924170176931082599661462281295209056317162918482992666863338084348775882385250747757281503848597583212674156575886304001859632718312736778348973691165164172431384597017664942612464842997349293232149760915583130613866326298848441676204723685405470651014980663540807621880895432057976278201000344919971357520443244843477729113988370774098018782852948227626213618798549551285648446500370874676110975240293898151624603803857912545306137492712710667008342736024445474636439304834779030349124543581202020919096279311303854394762258636357835223681098496848165396607834784602725517940163424724960385662422068388037573462433772548357188730527670238711718593911892219909816871611600305555919153668873221259237647407534308816236476961846580671288998609618185945135573824929232240372632409300966228227161490736325028456370573122229353854991519386176565888519212084726577631385269018963139986105312639799834307783119923164279861567518836634967450101619277007464245591614060905833658325225004264631116388540983061192008639848240311152745972903536931599963109372153728035734595161308686395110581990740735977556311855141306453205140355586660602397343007765534517596065040700796306757416911632989954866497544559431050220908373268476539806739039119709907415319547540237510262518476392167270449283224496415151378070079707440828154144238340665364670520105669951521180763149735939555059608460592005283177611690393750280735530180587953768833399052450399938112730119905588901192864795383440205319174796098665753370507185804642349745853610579085751691462312134124141068413175010939033575675663765950389282185870418568279758903467617596084939248266507931310913252085793481736032692492905800945612259150603093696941996885190503963339089166756266954414386441813884724395787552947311397213588866453333112221454323985820084555977652384760034817992425329827151048522574293202753582988107052406371911043006550271630105537401739999455169712585629122086267242828416727083843475535994038748089270406007644168085413971924575513530204557138903633352173762835247068041099341676257821693542106007956826360861709007099243464453978974670899851675012988407204367376679909100584494570351962920225744429937615615828599794924075457072720848098735808760797663854697599325960443485257583897530436016970215913538939041176974939036260069573273258514248371955994994267562135431674449872666787561059377396526674888352886355571299835478174640310315519437397647491553523202677881905612630526859014217483013560927202499031343805316549166484620455090233352948206897247104704235324064476686978144449947002705110816884133103635188410914733777250604601693900784727822164458764316223128846205604110720513895716391154259982734767408216012921970627796869694831818752107125130148868281816883493884841061488271322612101409088510755401078796363497983420143063379158742891694321264491908046264295756824987075271578892274598740171507280870864742743077929655806433132685978216857500566611743550347046247793037117257197578263391986627085434303725238218132690308210660395862805185888541571285119919693697927295449404925041813916496515222394810272637919211566416593618511034012903995029970121659953781409197988621823628669427491065349969389589851674217930558925839750737896987422979604974836879849268199615673427270584951793984427284200168062068919859156007494621560801718418354840678965093204339254420088988746029614791247849607563116338632842147938370754558532925906408552951474440253438695841827084877264717469452537038025581422351477667499442776598075959323382281654559359470660503803950918465756588284070425582273019874445791930720222989170109290499692272307129446985674820756903836361389694154866013523249529905695227111192786323607761121595497700392284820951569138366624341267376970491629838985211371165585250113227879821047985754153388910188736486266519639928660552739654796822191469474659999488937803609246628637067351917144959698434794743053303001401042407196140388440937219261952349295197272239544597138271819353915436420471568258477552510235735931648957808794165922844655175967334365169561391725135741977648988093004754046464193533789733915531965449484014653059253867429480528565321866543270534123396410059169670761671347866080482290116333589176606985361398986342901053939745754956734854720001237786648322886174321215828739603845740805945192636223186757052926230243157973491088765926273636752366544467978160817029976598001069012031643744825817279826404867864769310405275945684265415482113374886894092730388703664901485863054388413968409320655925449206976088467699290486021612123805043176414799914002551270131416224888292269591656181965544586555274755766464264274501409757535679929376664841081966542915513496538117583819914581628424076540796420953947710154041930863357579275406402922251156512314350796936297508142102793501193113168536645372456760871493050761858257328849578103629773430578912007590052668611716988520270805846778012631488238870988238716106357635043645657638802626485761942308799389905595823325283667151752716550790656829649954925120307604357690933084122929719940052170304054778792445034986685357549646775674927030127596868705470573651984409525581837930370263354750637301908889893850827890069232304319890030011739347567225769703647809197222040945433146105331943567350667364248581636039923993766595556339213299209251961217703391813480736801370718849033963920367486957147639247220529904766150489867677730137592719727150027556507680125382732954179583705064326631903734282591504498399301706118087785489274272989413700468359897035097628174692045817447328383978918587786415762503958996753608214022587480890797558017304444961084599716914753851799633616749440712355696440642892880661362668705720361679945604095062719126290379300186828686907764056912979990250871752502478978499203723506251202531426193638752660910162134583846559269449470419991168315430657804093513322309247823859288503724650493861712958295240435953429206209038913147317293466836492082623356677643828325230204840302014804564239224077556387053062050359648548010443787279010690478624818990519365597699213831165612419354363004807036295553805184440650799144943641828060512923010841795894085101201207050727695620816564009164549051016398485087743456470570328024364232709781940311938980592596555533673756864758667585808098798399622115517536592663456449204792979355741649551330857245603692792283956677585836991677582358406107043787150165107568376480690771786037382701411360626498578486552521258986889377561880437485065585332014785288349245216120163940410433552882209349690099587174512942219909449254574679867058124025335792712869832089003089266144788525890519290600880189514841755253098807026535755885920575612481111323063415300913319625265179760294289283275894924482878426464075215881426055372518117111027706859023486416105379528187558781269267483566854690138052720555480825154296444434166322632183380920090250773347897322536139000576616087247430564865842324907732767257883475005330795273621697737074382447133884271974671474245485985410257783288121127840494565437068308632704059275649029170203150736931596836049122246808058033993819252549297616456896150917175990349932544956627322878571255595447270626599611174000476969627231673619265379169343741649763815009680041014673601404744615483129186215568668876443900159872473308206885051118317390791835344100335499527410801289696543307520664227610104982256982858523067943939441874790567206054027711481310641240558978796625631250226150667723225810016945384811290503937972300321776096662765718786469070103536115521867119828523209909024846573278492864324631719058563116280826061768884462253499752749328991314495065209376151744192708827627879330405116714836549763879372179036470885510443675319255110088609483429125061894898860703778129088982381988958573493134892725560677273046764058711314006700309467006951852446366506542867008269807470987717802869351600454797327831169560823763373185068432857918253816300368226403826603544046061996907327365805953759613628056452850578606048693459673010209509532280104569319764489027012675598738736095068798416723838145001475195598573849738369661047268426514136924111712128901605606129583304562643024721803936919577861623109653030027241026357142018202638300367070151516068512139768990469014748387004527098461989274536651526150806439428772663175518779049729574522640067028798103261155282980119745563144565124560331173552915630923648280159453691569023420908676914197641118464760141914228343723546456150353766565313732406138439421574202735416912731461808156829122827140186301058193612368262442311400016417079397213206078677617502724042588897735435446290648943639840334304277393767287537515201883254447402623164753085028112014190884923979522111114033044235162199359900072774366691768046638759545025281432207025983935761055363253238729393741288874209587862581398673093617648892293805775406251454937352581160196235068628220343010471624464138953177747231854895360065932864092346695810180065191897189430118370679890069336357702147032113007351864419782448446243590777899363844097713432640603115632238664485950640124262070623006560905124642448614373394671391283565300364925564850994907643456532961420764039198375031005504103896520093032364917974593576285472183148768496925078159481920784229667270351473142554645151942409127052051748879185843535722661754174941814208489120404390740398352648418444636706419959147802243663323334527979693838571175715445361543899811843154475067214585517687596587050257879935058649514595142666080277272343884176318791319373506688088199816131468549019437411399014103240636681053437656930421669074214883380497291170448800170789096145388384990178323187640686342013852478742910020318216411789051678111488378739252174940952012090148208843984224161966454871443897961685076676565391484066975731741860676515942612141705452101715592873759487859200050522335673744982054999177574771042259834866092989043030627244830063570169551300180236813536174866682435279784905093934868455117474590325529062247366666375344233412575844847785332850249975177081582942264842848125439152527149547331967072548687432553784744766163215256001481824428630510920310747891708088465858878123809638513514333887809699784069949429598301384553072066672926456273044394003646533798144307848403558477051815355640772082224295840038424471492989286749852332684484217707211643405892434758131239258508828959362628580801324000225335285233698793800752462615284503971876238730582152375414214648536219562304113881729396302144749516563677181191584443191503021643710445067590859614419826375100517592335774945378282743724468778594971245842131553271416797598777457126185618142269241723787156864477967793585738725863426385120895533076564707110943317128206781543961386493334897109080346118340957836788091131337643604944168807015224233648739131397530074425312535199543686251250884794666866209496569862210614978167685002539317268402601480896815891953466574631348549550308441852807475797691387730681806762921537118030028217273651960663304788286724850091461023389201505089986789872337153389351481721739200991166261282160952508522063677337869779808872618475548302355067717314448269505434102888717331466775969398050213728095311933781306388259499262459192525852614115852148564327969742803014250836269617332902447964544882100779944076889975413330066538960949718398227497610334249823906618406625376798501286523914352713535639753872464321754258523067750206336562520922096394622691373496538348314355448375658098141794140171954821825082368229503401173516296646725872261871559805007302779620499537043890947069165511832501395947821431672665142963972478830723602699029606723126784741602133268428724341511789067478583600638002699162653959670359257639777006260537386198815626634835548752275393385258015750523683541877213611561831089936890434976857654370216089163868902615545687530177996696289728343448511856146746452570304324186851372743186563977791468218988033554678658511306831861246723617778325724340409021892552866779252442390454316388384844019544506348881147661552893669320945509618635905465440873276269560060668685860833722977691041720090227245341268136563261837277253643078104833185003163616077387414216289017606672948556160807526670282560090280602894710178028038181021198643916638782067582141943326834719092434381740338920815734883780140571418280204007082389334056619179346201292114843828749631279401553140803152963101211362278885303412516061017683852070550795078270953373587885900136456398462918223098916481755696673879338466001875246823290998240181182275931436187275655473800071190311157462928665991851697572373274998278748696198683512458736476002458885274799235963794495720308063909319250519718982461945117746412588997653963606722866123827871194337652000508279686402720612409479908785193171666174943439900377935630204603847112757003733367194747156119434260011726441808469596932630839074312074041631228100649929883732537547772709825603304795190375666375839683015314842632036967105392229316011185505830708646076681666752096077322366617842364839419913307946848114301964462077695787725153372605880580031750743052032451993627536972098907880781975112014254228001735616186834743797043237031466459782264246829764627242928646240828857718036573204699197747211470190231832926617097189601754715207840685297096522703599125776377404110668054639827655734460852977082564514889195503176115704316944866228512478512914393375907585140314537122598096827549585809713300407399137592395953384575843627304013115608651734429570585965589958640536888403126823139135209849700661144977119452599517352926866937441868381408926598455152208061018617350057869249466488025762394591685417472360670857571785294119108509556464938115683171711643628158072143695450311850345128291495536435623050408995540501115596817041044431785675810242461569231028759729300743708119834096751291109911174693536559353089046937937896738938408465765003627064027032720919373788426298851421585392174245640679292796695554712092596646375507807974269958499238885660406791954132312762564950934800649517482222494309449782009642489094191433026145538047071579023337996501044350236338877491691963076228516450279082971339063682230429666975727849313390761026692307419876870131769161004910927094045389327408862894459216685426550713132989484004788994902015918555700884341333793607611495919017369409610723580427670211529193791447899170254284962385117916966290038856595343033069442994980159401185474796461411219727064076362894051418258818589036754344583323317261554812368658892978079719063390205998801397236084825487703462237457736633462917624491366874127260856392580238362161823916811271025802858245105583708473351115903002400863343478088906153444306155144217287246432511565091628108607884944665098821333327138581692558694593697402150753820093963818097608519101436906197798312327520554572877611023094722059857562638378362123766056734019250158346612904088570236504483761204527180993371363936782259529992873124595849868709595898096764825045517580415609315264644745460920056309254767402703825368549160608306779897331463895923853747882725431728625951318717630215746243333911435417420771674278896721453538588784839480380561409074087336919154884044001327725788660995588169897135006575503532583059786876955167468156950076536837178914406437988509103089514186529060473697497567953620906051726386763908244555947492653250028956664652176002899958106221058918851485600979879580817509541437331902539948227305394794003985291038409027571134782533811289228490940665405279265988055727401627539970018878742287578379803679611517433714144656764503115702623111126225220069193566118371263808320578527530585188992164574100291622753352071384827506526819940162305870993209615118247548368170943474150606734392551044440291854296157305420983448499470880234289016334557639840160439883543565457031256129854398459448702456274974987007232518981734785404908772349011540133330608519805757938821925054801128720708368737585774311036654100452030556406973746865834154052495242680604700772985358465875848461388874534462915034190062675225834808871987693245091026695723302522896970497126022677271097919211231177190338170892193838388254146369788773042075180295976277773434955863885547190619265355538165457761968639825062946446015521380581894863751740966224526407846075701437225306736970517569071308390243952137843669099362177511967446055424683408825201269609812530326668972357180621023119316134478292849960514466337126625906088817873083906989437940728118073864397244016775626341409286839275098975109849902335762764087688893691945873061123384753588495776844573989322919485254665987799711247549677203459708672389883027191584817678245845425018564686509383754475614225689578224801297462709947390545687251173974429706728162710038269344817357659150483946332524468913939440969857572384786438304707956182394943175592193875844596305221069231530351833122910125219596617534390972967768807796046761177540425096548610701529238534049675464084486827193168364520142852649592335757527290502765602734499033278050685126170238950683021165976971726555517000214887146400688300763370873689563516453036383035860962778153443224691429448542459844900986175071302066812245939787555857709467923114952378705071414081169700555546769178305027199189860555373621879615312874031800477416115768430528736782448625375459305730699493040568521774706170789886726962938138906190104520491223933746934550860748589508178891665755214215718567648930990650343174389815007775132210508483217068806309678075912268467217037390909528528438124005667848171732175418623214036095410783789421800093573690390322307345707524138708665614817116853493996370336271363465256664255062971129411652058704786010060494240097131523962546761859523030895576991948872797931233130636698720105432571409413636508806263692313590091014778198026656119794687760273803742492095899321051673683253780058178393072509769868192827135742268761068787896448362538211993276365043593500325616039334784711381255519991736497682304606596814889060551844514864883834889294573943972054089299549546649877806718412129097547339615084849964941000952483346011365911536494484392513627900969466769860408105524099863834637590731670581677440821980129545546420720653066638548116785708446945274071462181945316779690519233072340569147781026332685688509703377886414141956785343119348647008566986882896128259188747429858018902361565501071810212553111826257596057135819415930603498688413855562617931733031414988129997777064636089153010262230094322227366105669932786671766628031378144000312844889189569738487147068082299705089339896133320503251349150611430968651539649374648368405527319609003043026293232639075813718309813720621030279535904596541624572975742889756186819858179818738192617422952078811946774796062116286412334641594437740567653764936936304141589366031460627277096808111312885364116279464233344351310942124954687527791361383772200911445499959807857837537333249631548099140387628219492383902244954403177392163244978263506347794219827858621952119893685633848968540107217991122078531375892252915681120250415084336793022510712938621350529961289974069298307010508856948109419965019425124111624831009326153777928802326074275328073112002728332942690586813664381490456428660346417739035731191126941824096559901562864923733113795897990487851475897499149946469045340286338416207726495858267454200032462346938649369604492735197745325578030382729518568496354477593470840109551472965749409620103296016539777276083089795326471583677628257961798847600675600425801389923156893435399831769130072067170768595408364883386912454586804890920301265247444010463803537936033818300307672155473714891263378556669675648048703211663182612190394629150576673400295965345845237030326052293114124823499055182436555893738012426806156000989501780558045628249749503305023813078488376810782699548204271480765687510012823572197617555169647050205133266610783403241712690331577253675277247075386590918596188252662306359895597822707829753790311790742227053099463438079004501828900686698077578478680775438759944285504395690600822533289709738277817886028883333954301094451086731670771227417269678356726833065921988693006080583373577291457609063653983967769433710157920783969240282578366506325331565849081062639167771728957934082214055968828753304403826829151338039489521826979059815682156642779298812137056020282602053635200783638028842635111405640050055330758608797253004683332171930822870376916449354417672437823313506775491006294767583971937338617381799103824648131166742940980926083125237076799439162340872791141263115693323048769560697882098561292880326255782188134612425612256010779665414832507966214670326303465200929168065897659637224909657015909932518584440192843407764473212994405399548722223365118463969358149690691081473052098026530527492013661679463181762544056982717248369726313715300060670728958125356613479397624499117017020486155000351611803340962535842848914031480577107793095357668110888115579209107910807407684933114539479417310300834044475615568042606336611788761753106469731968448696107294951206315778187249736387978490467953440960405682941248404159169892283187402227684278099059954351586601425777308637457045857093017869776616116591339284861581224169432110263537188024232450234429461575849456016249519310957034117735936597734430812328400409904860447771866629999498890974720814298080897788830919379538229975927377613325909267903426427754359455051255516555841217572679667347805051715111060774115442410100380589394733292617487767717248494507656479171769068525195712615790414238361081985270893715522003081250114560817945955278966422547215492586808402773117189189614518716567480469615561569897651393048764986817869646167468845647582471739642308110139792736277263258278940116864127889726976849747848758470634876791645164294183473251616931194915000771931107602422484008032404816092863133767497447548468937998609389411724157470512425257400140398635908767859487372218989450925683722005243381885627977238351344378641626217202821455428136967848113506692679514480255724704072923073626127946741609592115300210077236652366008143066349651236531995683780072880801513292406905251212450246642863450480291431385556179933592592848952802376671850518788295709002834219008506602874844761715667212711072058126768399605679835438562238015187081337251586412373676706800463502490551976118565682351275583649158312619271877199052815120853705973920848678358862884629603836380973571681774745553137540632570182505743137293066423098547453506245788259923222189412972761479976331037158932805943556395761359016387113046827813668337978079918446817217629450543957603883294858700638114626415140057564620729103394897959105847940650016636738083911886572266417414786393628642789122682763718745497063302419354779773668497281991467271611045698193471140042421293995811344041918755472006764713954031067069402686845509870161979230324832175210750873950129537604624813558933642535640790601158607101318199132034444908494593166126873678878369990246583463388811429336251809289999566867098232416637618973615807529679575384416423441083613108964849650592634298421120444140197468148670748239868447611697290903477763666977522099371574797553012812914247803574350859710432566490409708679149587649701523013244121233426486968691807516970078292407822802037856680662579104964626729378705363215999718299203754921235397447766654608432379508641177001639051829068815138652570367819425179697014661123856701219688056203290619113746542554885582645999817340593979315133274630772673944697756058776064969111712997332676920624549722006092011986582054020832178268845233485345100295869228669908162601435920131378179015967108745577031650972660053934118324396299814354885426091973573149457501845817845039186130856161678333830788278791106788321720125259208356302800245859365049477241585279399327775973638317842765515801555340201996400774814056698785684321138992089972793606924666143161842748983871465576232089128636932945331305778724248964312025893096096914523058019391766012978444719745388317744914508160688902665500383116451631854512014322053117880479566793890356233437993899715489161100390130285702979335976486178764341789601322526604800185225280931196870501473265218827300302271186854017391347346508471413925231568197476735536516143991730179939841940781273995235126506853346209291701490460745825589221665789416683406623031351444953276423954942085514599739697968875874702282715152344345213986359434258089705564554198215010764894430576428721562240015419656129674322268376399316760075506633242908491334102569505058968608026068862203871287822765904195274769869002731398438873290603955469019015716882691390993229502802106416907142982969338055059242729487445574092949380924432228217154574204143624593430301318515096280442362589720772616943973922606619085094654882804944751455721358723728430828592835429447995236238800264031688441500483079637696567794797454173870277267733051569617828135010092021495382095430745857036367742821799407148771241119215997304115810511835574432750547256660615826453275329787314676540646287545884605016080009889274680055340289064709183306095550379466011068741063680185852578764928167980476701592326587822244414723220425088745220049701250348209754037508464578227090370049003569731895997001323088989062816191028252736967854198568937916230920807473419639481574356607771544372197067043347894503117165824612164187630758833805517270880429351466277230476451629565878417080571152082389525382103072852583331233052250521641196774002694758817413260926124773225732347164844357675549084791924126686273353342345372028518548886682951977896466939697940137306786869276246036479720640008376769436558389777114626382886685802715961622124363470246323713156560693001051110631185958214782075693430785212498798740077607701060945321235830210216097549760885524747080406123957915838857729751538090150499978239697358065237999483617333925053767677697706006569191129390384397290260002499619806193643038687995864415798557281609083332444709844333298504657499724506530689348428506197976981738272818423402724796139743505374841856189082827185191666461728852520781135241692207700381780427179559252400295949244765997730861924243670059377582457892761592315930109611601264916932977717470554504120747651397641711773063128855763069205086147487147789792471896533884363751914387037357465681623725558698480117770989596862641564228574938580304489050971154319277010950970319000972428675636403590379605229046130849820915299223288321635583368077406265704642636483069225641478753648472944874237199992312427814925406234031429270735865122170013961637730184830212776231510164367941585804217977175105180622325238190778003909132716695680474813796057013262582137752167800601945568091719498095685739292589517397079912472817870262167786618931574778607679511053499743524969058250710715092781876363257651145412425731657489133514619246151596678323668677838467589833527432444705643090622779275764643087690548904510127969150324968606214313560350106791102648301211241653095616895206055571857064144537302638671803893254216958689867980503632500199467809562376819631123216324150308595022828926991401035978431034785902318453668782642077475195107668097531660338625436734832100248453623512926373765273591949492654019234888423019750340416722788070413762602376777478140529316738740431222262050905065480518060587166377907414737738864915318325804048689844362407630399109907535412533474309715650444732080490423805867247921658396392066496396666435001402696168342128776327984836683453342949176766881517899516538991871671974533504631793349136673489056765480541095490026360179643038893397129427661160966377918492294605181215030359219906770392133246257200540696653059862423912106523112274670354152781438353460283484901458662249300149306686979473454984340018848651213381924445707317839567910414651714723455036394143439724451627049053118862332467599546480877144376727830067816427338575239865173960052402547388467167429212757633618743385390499266100739542793260452809582569400227683393894085810211159833992177416935043352886485477066330721544529416097037842765921580603066989594441044298308431764316281821260002135341209455951078390946964815816594778074418130765620733359636348604431129550848463263358303295323500020065810135439691779045532833036766678410633971094246688213328887801553813395956571280378058378235473992680104514005035560182526988748412059217167008237044934148367983349023078884212178669759219903842373213140161511735181279967588465049693405104122355402821633971356884115145881784233444653616427345697629266059062088325115739524218590549694558981242951763108556643699838052463174735877883604548270016368846350815490280448309013857552845120708527935560975390999422009171342154353164985271318191325298608244713940471314678427663845859922136360809947041379307340238094730201852533740356413837928846062664207292752551071247932463760003186970604040770172936608901128991475644986245913409227765487702374506865341138750702645553758497405827585186974438006335677785454760290979120837015187412470684995048428379469886606652256499473661238683843242192519793070361362063595612787052621753422359674095237560610151684535523620308945158176125602596347075242977768045376316781434685372205163796099678086510258618663386635055502148410272595281058781847011283570525920790952938852108257424627858019048319656138863336967673681294344328214266730189142981977471945617845021396414720837377915970263978683221869785724575154943379827922206761397789955552091592665451957899102648526572191476514087961390167055513929704962301694753636466119176064756845855914157519261253508485889987284583976593205536985509244132756082417856615001179292333973422233245038924466446260062152148832944045945691742662620161464441303902250485603588403059920030927362961504752667145943846916910533606822678843579612233326817207479780667127478590613506912178558787235141378655933914928793587027352216756027046048533830119666943712046771703399263256756727968411373343998312277694453081962857837829925112024184009923896834337278656074484217322375346105319711470115352798358482657968115873843053930230813903699427075450219419113987926725766371635595099197099203738631685447896869487319944971527307737107816883501433307695923785800288898443115007206732942912430647131388577235712908747709336346083760152068953352695709943898751579981637959546917434728173506752989014292858631128030729183856770461259611207795233919541808377926442881549712862466408528740901162783514349759364982246335412325299197842030824229447258575944383872514053731153967273801889483118214629677219507689387085253396980186746763523510392787730309319881788291919344195027864872581032481232373864244613551463318626901312008427014192525367566294697019502814249317549031890287086533446033893163827747057501277648841501923097840778251023544554422206022936809389940764179964401468495324879233419534432848854202925800264866894474956725709706156921266482199214519438157977303551990476720818195456081322453604182734435506658122457567150445455385435575557401375435163499833582172032972823838901907560769708731707316511193253320208303780458241202080705990804701928428325135256075249752089597296434637121124109542288933140753734154641478219325797129145048177856353768213747831176418413440398735094977865091778192311310385527719589045711274841809113094785042937975102627650548451466090206280853440315544983391405318932165780551844416432436133948786869621864911143630147525431221793569466973664558738746711530508973653841881688871078614073165411767977995997600409137662201292389963266575341232649433949847546981556358043862262572009473116617706404768718447043690678026436373511655263597460106896578576990031506643544832028935020896723116268041778139870081749292920438243120999009681330811291871702315264767755897143803279454290672265527421312255874853440365010136548707396998750009168118075746242385284580905666586207678163269625952613210443340802229769360637902175674955116479750521492096613111058211747352185065143550187586924313492682180946883404578991258885737051949474197041866745283592249701577344994237722592570264552843018776588845988560794065672084275236873607274103008144356389587967776357799220926744192280964207173552713348390157601404422425542377099724638356245534026295447551492153126151798190282640248961486299884246665994669613407902569639990814884788543021694307331667466785101459712276234695439098515398728857475470756129092398794332217642537406288086707548287143609695475107337778794444593634105094462003949315150001756948457347164948198116142991150314127468889881329548499602485681546129453164661583901516244471521458533887469471835440131076690914167183749615679851586672349385536902642307328193480179305217755984834360064610575146448723088487172717413512999236268076221084399838966016221216879331288045023374335974244380960371750139037864756981806321961904589617433909579675304453671935728971670388974825954302736844204951717536709438816307426764861287680574028576350166805260918941112425640772003821374577093433236360084365986044312869578490468633061773560294585682866831134555988135827324293402942598018151360559769010579164854948331918489925139812760063857578735697285407571737165549011768471902904435075554479158408220691997090143315447731064034097464046817309925222069345762394509279283460119776170877330111537713713547544332544410996781859607981907865672774417058327650918762537395021518783964604389409370533447837154647328777534169621618642105669052097520539094977910832279207074979845468511497056464905081923121842928934627423927924220317147651082088405094654900381381801276655837195626976122488703520617336992278982347822198575861890608266115971812089620918937988571347702836222603637363573745144757309117700872132549753123210577347253247947175404166693729302279941858856901726748323519763007970070917535107023402815363915800623002373704062428913972048191938003098890653510024735294325888193905594115976419627085976856426908870738338555733710678587294464356962920399222136724526806814854207721307490537237174610329144025056236240618861178325284507248866128492892680844830646655520137196268045627904741792216331874723691546409319798951274305951997493884905721593695310134193411879555394180410711155498147494742873318075298838866512929232578711618107891745348075093060885785012852448667176093880794207837158381591804057424818782247218507014392771114460191512792434168374063380911586887387789040614511786397887429102340827023023080297954881712834886646896845088796639373340422886650138846356129870538818380660862092149300027693821236755943170784858663036608310010316657761001080431954607240125356961813425470425340900752810849432245893604088386583270961222107110935992190382202265539280412032364817710835744293594486559045248067067791193687246313606289025153256154952906178226555817333040194102257335479891685764085892208268495214606436559010785092557548367965266192427662906519307941537367068444448631089188739392347585996514635768946641917501394737126179373723567305760034831006747208177957728040073115204116425368203687065721118766599051198127617121112131931198749420741940352362066466661414679962450684588899659627296712983526723273399701470279673094888657038134089099736737223596771548539018327376434515600123402112632560237606537265676844640735967496604995895703021286506013660501553075217345897749572952653323445151215095064431213658441734831880499517770302649526819323385835315340357690881496420317705226126792498277495434967583452067429966251394542239908716956906116067712525949720523062423824137365430576163083808161111147509956339381505607244974475334771379534859703360198914524706955641089261961273005680463315838374811060196074284287724629712742294967633951832391006803177711796399639418887096810538071485128133976098540752781307221888010596558469021294223595087815780110222511599032651371745170925362535592023462845704241784142241857829383835857371089289371922293818156922412739014597376422737369730650355899908320489625906908275645645826246448279216749906937062882015679430815483795333433887824315768928556266892521330663098568563381177399441499363279861878586174971296280078439800756771099833753610668496815878179937022913526387053904151848519128726172100108894997317162800828712959898748354143848417373794996884696330694025987901660445636517115453657350945633165020167032643975689630372240360009562220734504970516978076422487633077937606081231880929843526291156859826108772507694547062418813923942463240000190223757836204586847446223834983301505627872711709169172402588715570905707630720799444951775766462143727657479887432355944179568385064740123280074030998935050204727969992871071579919650666900324164388137874566908266164637610796135634654127004824750628314697742226426672211533582636520278568896138035886654122792441301438238310451646656483973447426436101282403450980515675228751486259498949543164744762059866368541023653812963877341155562533847744941294246563200948683035158151942561070548814086795724277667062295997294892848788151592750371419443455827446133437437296295105863964644839926755931634792246851607753094288269079643765984900428387762563189252924712079423531649835718256528217097118373059725370861875122386477171824599307772100735973342030425926034237104036335914096205921158959907641283227136659971085418288423292762799208726358031361702468886025017480944432171048248750525021668286201923057498392237211085852679859512434585998736993027460799263100770107718594657040855678380786108326761784320102567510707278348045806773286320259413470371552153177411159946042973244966668977158170518440665110494802738594491856644643062226366549189765640199516083621455847256820753598153007498640166924026528637329540594467561192901777228702148820204375675639614917962817916840244151338726716876203189136217586490252753621271201740404728570690676564884348763557190884779924505570339311807556715051201633789307055856041687999565353206359949429043332424712631567295735126893239978908498083323529262493914790027907182493193576271477579669996761292021559371288196491914588409929548381180251610416732683260710101328466320278206113891767736073524294248142765971196979066916034177878930007379341180948940554142181655390241392211022916249906577550254976532313738393845763680001402350965463840334641251339635876605886019199882710051191262988716198448829039610629307432464699470060169620763442854807663744886758199258644129898633877064286018205327945872778307879023428586729004572562170971224002166573133888083623515896369592728269283099026588244995326164505709143264995387468541429202408185237431418662964541280496487043561334378211706631115744630338566871730201047457437691026439624219106118563236716676436017154302342793603081932221013862591634364515483585666819711646154132574940441581646796580112696977494419163909909687746933244634014055186578169755187120021744364871694737030730298123690924979754212241258949595718656790291533382898291725323747107070679949060278790213143641967361258837408335966766761883291310195370185249988594210702593409780906871791211256591202569221318097332295604112582146573988795241585802718186188776021109468550558738258670840866449529401932820768361724216349630429898418916858901898777061769040911688562864012617961258718681535324668490764259665149582508812001660568698629863235652664582027883439122809992552814899574662261529170363042123647372240700956268030735298758983459007393828525636682309854025457943755514903590264153134505988754492207451389755177812719359951645308714298721745380187248714046249685977404496882470071811441719319121390639667116445690782190933764161977256481271333083888743381487253608953170812560814433009165980785683086017355055704258853655789239792134338618849196226491778615420043291618487927103094108160681962363023997150469353005052575095072481507724911238340995082311033300405020583852126909443530856359654603911718219582366959785426906679058318475007270994711815823871754333795428057852672454224994233072375114503984478176234342674583153109320125410175931197511686146120144519790458779163733474862791822576789521664392114859122416695166173367377641288155982870955754958307837826290940010599620128331016727867095637841784183487749082671377968492534645032709940437044965863479943943722112605491854211198071586265691757928313889506047777920370192776883775151309017179074000158307616020924797303883126857366608366711860091047233614175147417883651701491774319265929788982820412119113918390796957833652749155811197298326340849139073955268907824711781133611423089601872593657636755566954342640762040371177752364910494194178079319900813386318897681139391333209328455658331156415848651265221476537736777540323852703464911537212567431427769886122653865489394099006291242428297659086862300024324794359296563568288988759179017468361152292793119749077170430202214975941728206925733851740346887819130730859685606958145018701956301703272827268787222297879062858738258321700169834433776838721923412951979227552688525002706710942382426555770811275052135307030447967698825889813275015868247168840583167278549012364822068756815002386596865079272768403073923974129448937620881446197813776360366496217669327046293171078293855315536293190787789509389220777497894512612371811532644096799870618089924482916311395774986336181787133109544695086101879046871151982031623482223073481553719297979804201735644812935175792951741260521956614614785010815556720630669420281952955677073232546650650803813430535980961155890389094202085097144493086916989376736360634499054832698845420632688669307094246759325396056351658569657523501442776917333398583937298286010868779970061612359670676940073460545451366233957023687292972602180275678955383995057749034912781418604603966556873188320299194250857244800551694073708099135502647688797546306068179526856639948977625207517402529973625301855316415401248054919390179167897657948650044553958613938803580619871035460061954167876685414562849564530283386016303913671739587576979011693879097846551550963523238802742061149311001019641589991539623216738216018188738609356038675799359831658697109088472471000951693086560686354809594120119016646065201154844065289893427985408872468965216599470582993193075967995918887440083658802963150343117333088797951615256316142615189411274288631719308589822809219108962407951851837935190389679682439050933231478181129560073149274612082770590518934077042428594210195103377565795920625139138737012899905872246915175815192135547500442155583927342610762272094513191344077043336303168578659531467269775376228093503034363667683747179451306217565681716635353420605227438299205249130057689231734559249623478888131468691093284693145241920735277267830591641755248218341833259537180717859562334895115425385047416470006566715916452402089225790682216925602306880178178796109083822054677966407730216383300761785173388937214624407461528629761790926576053569580797496232062788862803958897936418378167995088261946050951270601949710362098547846608217156506391108046653662340522714432358880622354386233693767921341617917790184303785302700602240917086934517191571010895635542239029042107759305064804594729785559455954903150036588785392150227581951083667757407311517333069840691540740339913622554439826622733000197883600700523513963760715252419804652933091877122457394850495143879684674958993030154884235911350921401268402707969479102105100647997790864029441789290124726721631081979607293022792447939782140043220376874742645450859965096991161148304462008702911158141804636043282221498418985566426114458439858040436380351281422297554272098176257319464330938846028799057509774655531310862861666689008812331785163048735547769974746363820658851835773811381814411416620528873115536561102119549847048138352713782188992249652223990579373545232026271475120496488927240631445611963936950655813722665162876182794675323715903933590828951395604137668394512668393305039703219784256620691382367082562220851913233081527262560287624239190201320270727116054854087192648978134758094187831905174323870350160576911487238563889797624208088545015602325159015247528443255769985416344530926929260302204048710743693512763205436741328281843383339620617702482400572666441769778064929470963861236252315364472509873937707364157298529695231487815655014618893635279207393094764525964535571643665167506391675442524661726582199731067276703045725206149094272664654407894094709293380628070165805285408369770096522418686393419929383945742500430893355900128847236630701556895900557526448746707420537893893117724148621549207859627156246187665881944907537776002776020559788075338529531438923951727914451083307127930368639491963710347213840480525599733190408092651672190361389402252781812757236345162017179086011513846986572479493525123806596885906180725129362144338223086089597887669441570482063814696058781740905695578891205452648189032618860259627894495198480325003821407422157134688233443255580421712275608499185527076674367771901105147372294799633135418882658060137985450819908941266160298383167952794921361380842266474323785612668761037393311731759174802291418143796903214208911694945350518675636029293648820254703886268934747754378556342110093894716497434708642117298869723584782158605046686972097559139107621451106950153850997651469142478305307831521353899204531000764476930908536889598656110608754029754855931752893884780336955328319848264797010624815828789838214933168135741842373442378971684199624750015758306423190499354628225523159754756780357622977382494081136444049815192567043157254368207307939537801157692460627498308092282912094251329725726373114722149435845462955199441859341795618647945813759980819205040836474119718275555324106539059571099713734428448819271808455299072170139819523313316885254160572641552028078461290413864257353125470179946171045128890672897703989304628709539331430645653644356010229567906943055661056336390935699017191102094671547620555600681571950089927967587395394062088898370794571262728256896459877022169899534966213225418385680804181842089874834481072151147227721542580679176350687843724428582438122181210515395705992780513275706645158603932614536133420884822122900193197422651105852098588375999883060891412999114140285299071375837210719049573808151630345007904671688318261862729466479978396152490882811445207254277361690742888412920155073393688300557673837981603859923107027959423664533404901794411886106644561189363345710840399083738758357380868277965932300757004453612989014236855653483670893310465593517392472964214094921320929601706590002295185360906618670698345072856743695821160089557736880036247833154310659860568085239334886666135632990399718149545750146022300212046748758970449116377420714489310882798988094612941690580787585764763336258865147553701477114925979402495901295348511126040217269925504160203143902260164302627446701344875534720627918737476835260813243898736665020470584221969612902865537862796076106954567114100530594596322151158059273516081244505891603675169532311320064946909019650361067102156182793511000453378798495340115487825459477907124840786757555718224453454836707909273914891796398539571169025482268491900745829785690623605441513915625860891556555854934161474636019176344438361918674776213776659900632315937208164375512012107005668775237253537924682811035645922881204149640656944798241322671864675167543735530857135138133337559868796348337449183209243768234018218401535581659418818222566446154820302806094405170268106937452903530438703843064751950810108268171295724938038104090681842823795717672947536009117723436130651446234730265902176055367505036158624499470073231850024821973723854230542382109954283179423344974436772409217508702474003788578614732878000546279255550643736819680574993833822353430208161614001430246783870108087698135227395705564827699526371942579731209174836024802276628435214047636570166255505663315118861245429389373309044066017239517645546137959289302525093260729225084454634138921918244130868519765226194564874349638295519192820227012559635299782022843581734277126068383022457173100796262063308482077450716455689673234249236630797864419027515254038429023929867615599271303441356601274257058020971868316497291124763404259871142928641126719589863594197489710838068190157528713746484809755432397100247664874157173342363627413259567793794008726462567477876691017175974474367269738232855248331052287668155037769301597051188014144783467162004816278306222843827792715827848399003253428962442128567385960050903648012197914260183625696504557962599991170736410018158485208743844892485242262961158722968767155115347878998506317107789754495282467903992338606587210047294414550370256644353095477738815179332044271162486567341151930463026470557646976118654476252337590554349346270747629705583674729067060545086897025231318886789865831345705351739362490478617762669103774123978649570341607250435827574510803886489082175594196892353488519436929114007212005451410873181688381506757779265116965911487689678061542122865478973887239191433547624125315793017833313188092613439905117861345637610082906704085534842785780987104518088292952820543971318438921472373660722005809755704298336516948947204547095558464174875920644208023616088493251374175596771790923674882416065181224733240241632756042217430985867314127765498398480853385569922093815097710648978717803268076462756143334750242503350029441463492152243939536405840659829080963350959329756043327032666999493405821899734268729903667889573601217425812793582195362597942606465239202298964413425905147245202672351364624630713619031451296372699293167419718596880693943195807454170040050439827760582361082231247478636014502294855083652087135016243377926151970195212213381036342327086183995433177496001504857844073449757002666388680165888293568790647739931762421837327342010478712663767674293925407451408234719596073207787974008811124516943669520119707589970457706474829627606354658667192835822992669014113465146697216231703464958252881491582580057198637338925569983287664474760244438596917757977607484877909643148178460515383408926898963560699575736720449857367706247435434263945705283969850282305852637444463897610490012681376054454597186059424635617471697259609502517979458216012269150264904600613594468796589186301600985573459388160732247140752358255610837793762884528385968207777643651069304350389907957490488210935837484998669297769667345360999425747642407696487399928785475642083701138804262786212164030521025819953858731440163504291544411073771929634935332378971122461198030096752410651960814076070849068424858638669457459082361868921719923251735613349275851143171311850287169584237697389907945065440407947150648493317470216933783264618694515267797966618541253692220446674270665892665402567417599979329858917696819092300083912502712061422782280228190161349888188120132517672789738747182851448182222744827139798111217305914273271463264165468890934598002064596321427568916215696457874218254438120774043784072300198906148207925744844832569531095825609794956605789207275259767974919009485053289456045879411570959070332471772191704438736532507372050415758316818081031749340663262099159020837628531648274788003427499337511895243223233748688154906012082571751856601607139660020443424048321978094354519165519133856566036563430064957983836194699502991233390755122989450872926930353819861335029267604954546800335147785275229717426448264850594712148548043563689496868648903873841508406301853290052734787888644362920848817965594028305072270267369225218032493555908507155488538123068295438561127858605839685458968737927420984671508944753196380183837845624249010633055198306153004469277630499764414522151681213597589632536852549832301997564649510575480500111826003392120746143121741759829234532084582651165543244721791388392179521751974916805105929935531510601634739345152921767030260483470335271515959372762236009046842734014731139183861260940924381453531042468244656653903448625018371772136564095324760284483424187386336684083891873212466839751609839294974497762079236542285660936738404103000996369754356762882977280506304141909720712037030417056402697051966638170360302675549526321556224723706415102754675208446673918379208392225417722849897362748471380612431221820133221543384954740578018507383943324949071793141434035659213883233506515230586922230240724078639335091590375663201200626461074394480417384170546325887165492185549062644501153539775461965046097076983389701694974919184678490919516373949471449001233220176101705109541984994129690005945082425217334112066914969115185239861948741462899239516874586274056487255656218791174516240198203335753865919111987717226498369964989651801799641982485261778265187996120418676031656724560846607727894275476840317166739311829656513275065399025511896711338637284817361100294778866445351352837180312662085036107193568589106575090574509148225536514587018672178579405948284954164207662092570619299038922092293783797157730636353219172672656030340649100157122005337930930234548869080704597381123040599055722380289983138294183496859711063330574503010393577253821114103975589692206594531032846792205791351058296228667959983980623537895159884711518253608542557612005565900850012622481920868619845409843559340517176716518002231805602824589079930280303897613243494248979015498547181196760213902057361284527673563623469129571990902966586205800574399086401827809419378180079066758905290010054372730610220596170786817848350927384443226445194689337755261511521128763237567575224464137690778400332437944057817688753151277227793369545932419205922665241197829554439063137889919116066778245998666625814850556946436431389425007321719704110153500031125033797791372559860106331205275360010027039265036926544289168283905278255181103422799468303143904939899729452350110415740107448814210381031808131003522203821071771792315950014738648289346632807349321708258370862630702884938022139512924754092759479568018549143307735017418794816314401884431296056846290600882660503486260430640342913138418492398039916794487076261536467192924617263202422500473652098162935494312879322130055425493365755023506714829001405130171755180721522031123989840200667513376727476121194163965223882215373211026152506132834811289389762377559719575556516081616734397701656193100436720005218012315770418557806977564818169318114709680936214513577102300845028099098196640982514876853421358899510924380003281335649199766931304524224750164902909331431364068224346037295365381949807460819654636480050263416366124608886562694965625896692858204023432042810663634373680468636033322238900307391807915610652093112255093859383717742360514290923115988855306015030308191838330759454488885742919823567659576968822875858866513529573449387360489548342928488497313999278549277825966657684435988720751341876677635035445592804977287406679953105769791499883527110141275543730580774089594031405949092560390414923066440074709741829565135391599455315301696242497179081147924827662591689678865991130500613015930338717606888561670698031121334066558363502516735862426651714034071497838806539047774588026531579464335243991871793959542253482889103651485218905808706014789387127045653525880852934618285607425168815012551731536345801624475152169864786885095813244950237129922296169243755375324100101185766150873807143125764879339272267373202916038215127332034164697981231377665928088112958430865514277891437995322183876083402575717931817953876600046570557744555319188879112601243269094300258700325755065125391081058816563119303090510960336416223424425291634266137672751595299466643159265697896410814209368386231752463484097876949540475595752749225663122835234768067882702256212914492243225081199446524679174375161246405896021729110975828537665000918151785721882432027273891773210152424750266264106943798206565989702792466704725826135767843290609775936622678074643103252774020762341450050847392779827033853355832512160099317480244500356578662286238947414971674302408430503940737152420406097078549933488836960915860940505258297023105798484081152160071557413960174601220748082090070412935614093185478818855284901911634006041562485662586112634984362721579539291550482576698198094451176943682462587833795242807248685078485886535391955722805039874971423282936889771138787130616681451729661990773778945827681824330948424484470482349766480890479372514530650719187771943793508878290526555514235387033713222558657121908295625836688642338177993719453960783236785339228751462556321767891945992244260147626548290672867858164900089677702216949834540872702225104113368341758306119031317523267695594825836465827655427651064511292553271569427711331803537780241591548277903722342779166604682978978431946132494844596894376295508210683524724373843865454730333016982100306883239015135599396263678952660388188996195072024973817885708010253819840223492221922387359044943601824012660682089252793598657953735691496487422254209307086693402509347948459976621118263412769495475135072917676272722845844973352510317399087460849203360208528332018615013961185174917014830529756735743573839133137746285473867175322806777087386366869414645646348628383689350374883832818074484039260691608725035437508560478751728538199876792121830156453407858082554192103873206318478679740264896742575484849112280647158788181438217787918611011523224868943643366944735707151474104656473425701665498359641592968445825831725224281781599306457301024811526604691980030012119900117271967240031192295085864793615497392752747253877371263037651750196085142640162050008900137515028746391763406192231747898272298990724892632302495032047732854650100434856779108021223885150565971622499897648574706840987973644073025819582094161220693251832412077778710906356233171045607169336067001868978365075505103785322963611362643392173301705507185412689305944145688561156368692671657929809897437144565438265465898497128833214468767553573819438540514539802572952849285497178500630495429488978600778744106400420026658904516016034794118485450955337452572458428100159429377335468509964036817726831804359926524697200904764884217965862545537070988295552270527328872869560131184212797475444533033045413108417849366955303799763638155857162828919023631084122131550410641959375355964816082461213443369707308828772967590402373066127469621661928576000872773822100946933458685730999125875859956830273683584913732746842715758492706840910969325646708185546886371643844671531044188848221731596442661109778639084888701948826129225690413072793787950176705483047716565506678276422273411924057443895910773568533238864401060705285864734833088252545318150009730020180510220316938889760023769681828378264952318339796636884930672822654248277582133494341696142429301500049927929938995713067094800175654630220547757040253771285652532252238528926888500677117120468091823980202704781016609820793604504009914012651395179090612553861009531339228986152205678623894275821516540745120161373944778064602091091274126389144291055322697456854845204196695623386545599232532941329283683485365177225473973644016483902351868560113403620239578725215943922119833367966292332447113549043064475622394183698188803997124295107418425136080571424961235926791465953468859858551444762073291875200399057525281476165983943076779167864146819674653364293947200572506294475365233738755164179813567012646102117531840902963248434248345332411054164691604035753622094450809119209453503419761154723136949734952223383742201454016879201983736805663289916470395303451013361247483658447316879649873987387958215859239226804889525705291026048963624844256098873368778386487309210086492304345709458208289551549005405202876131392523020798867992272575385418628450788096009987764702454143492188202350585903667755853754877008370232693825663523207618585693249096237884427345756639248168999841979195160971029950598289786946680917304837157839212219951765753485323421909181467607304060238718523961060598147971872978633848892444154539143846892350273384573569824960565852690347742147401058252805724308450360249875159260950907351152586571678944581570084280469014208551253966084612694389715072689759233758010426000579902045959273264726643902925677838402293857340623927901236339651419458360274951208464109655704816620919840590121138421910768180331120777047638567388683141160106156840571597120638653971953004508850153628178352061196850580487895508895288779684333271030987640071297538501457593006263786607143810980010355821255955450760190782153026740059226869609587787657211258999915061010963369833956855675205897095277482461618890224350122261524898370372756758854148523433165652445156516262933491214097666096637462746937660918592091383843970868041138954840353485158430945069845502253703305543725117186475496088279376229142944815185301295685811663576105864136946437047076271876109501948847010977298517982569998692097913309416705477075514993211431343363536461432337417590284152149747674353804478100572179931222367163560267570341064722654418141602724176908482365363630125036703149361103806466339400025033756751147552408443421694462517230826735679179044750773706631287480834137131413610837040140241942185825924240192173096331402100512175670632496899777487721231201145875316251519906693486443990705140516243567182995829637150499835635458797376297120780231867130231982942673953877277806123071791874200780909624350044619122560094147438375762940816560693163177647773124129441638618696188272490373564678437948989533021470405140938129243976104523572507822482696737182427443197015081133213312630521028525553006193055095605247925561221441118075645975733460678322223036231973923786045567724183138639058693428363826187611937292315883316130774366013095675150927424545130346191256976808112658710574943173967312953948798445445515358816632986707075101076187591082489427438329438005867876040803896139082534145921882417416957227374563875133155689327688762006102428965033457811560552277848373992102146753235309086136749947551194103564680029935014149265631819664869148261042755220161357532658406463733873522937356597301560449512701989182880507494076039819154898829549729635500468535986611318405451536120978885392187886332570439141396021936849505537468220664953652414309441333883957740900217835501906359845887342520813689670912357650241794761664545365795320856340657637382003847306390887359425035583615030153950248562706293036400238700987513629398269353577934300081548850800588473998455463568833108430975743825199360132212743973290930766266715096425766922901455894709425689933537964409344203083070025638362318841006141251300097437160848181468907143304457154091358899362751351495262069876412088574066631971977727008740499431943263056526133292935421861192403766737850174617198474486262799487510204037788696951292191502181496927824591161953705045300352363721417999049836730383832388721130986662973522859188919668492583731569847902196592080039765008166550313598289742040375915879977821057138814552485403082681123090899060497578666796308905769826451692112119227620945391726406404012150073851159980144488843663470572331173888442035934835802295063421410175903830685449290153460079151432955858619802641359810376846941730358645027066743852064369611139722823401577524990505622102419508732497253626858412113158405285837854875423002058683368866467086642418983720723328783358088556093450379106598059555688483058974046190695294148824676121698884199023689435738903797026955872225505174836818108676435592603580004811313542577543551058784799212649250983701717243135768235863386122344522561167383197205035796069568795848806801351724220817806859007406204674517750622109550260735214662171488094878253876735072611270940771698734194957044512181105516281680423230340444784700940969937049595279554742614304021324308154652275851370123908139570578936918099189344596924747405823763287810895074358692254368558843723697004587036287106646267561805566348244515439836118385462990084084176356222584592276550007944311382028353259601144056671277779746706215854984701557755984437631486132126107477831433965645687811397870771835726926075432628609683926887124302981818659403386691201235695463120049190684922169810119291839095295292244258612764283081455281560766553272429837133797709052464279285260885414524596889639404208795565564515589020510264651537017156356142312770602860662293124311597531353815408091138532416612045610017265182689799400981597205451993513883550392870083933091513127418008366554427842598182363000825241493601798724575788043326725330689545277856103401578857369789508751328427091735219403490951265373798799005025251673114119977770861773278182063797969090178550915077466617240225153466002287182765758055024219977870085353537511592299803445550476900043620072202381089861802139515777984130198254607995800292248546447791072454051252229209944387254124797514889815746198068830047554885751510106454128355473401682655410002504938916451677024897990338578542651715629198114105188118672257299043378433385798950755649219906493885849561404827667441382100381330251809397939081761025084004174675970423267469989945332433510552644957646594233239273977049369882980453642371032677152263713638980910266606431945116790550338071133615595017399159942660945735401846618375797548321434713203639019845502304211634057740189292472728291563623875855728836656045477352050151797182001243233176035458761823265325799318284131642157650925184712713436074465811557554944277672733561435421771294313492174892843997708262856986655625667074430636256178294355970953182442165610248791961685321805185146265043175109933221963543303631078526783515663230649772381052484499463219620881225973440016363006894724253833900241626275748342072356238164409357164547256653705877366641286147029267857150185794766572848707824254728006160603315832656767651528601358618815348926426788966045662355964011194305103985574458216413399262814474598616864694485863075016350972414188147081105920184009724886917263817908493184779967337919733579464385495602838789816093365418268280018253571191710673102059104146277250700959729951101427895543093529705420640723489898117047062586740460373214238028234235858081812353233922202809768811123665249868957572189503501840391304604853877855008514668141444405008406126610021935031444577097389413891729804140180515539147180712496889359037036681081566979040538609130090608202917593545927002573492504510062136871106776773674163275555922165190631242104327688287519264598596593486200259714168298646463105982064859060427625205873425532352739169676666935760839098843823936335086469558740113746784450745564472320584646193149425918894817508760801670960416561405061263642533303730399786417739275398005052991540195480408867578826224647649581258391964104175188793241405757543795296684378643085322813964771131818612558517358375838522694840974206244112346736687612865736458008188145826517103766228440901655823774846456257683540545699966765833056534854799639338215930945707718527573202700820082369191583541344420785179471213491595882845107975518090407439911087694139415943518640799477984315244608221416300548450906931701321533231153650997085857278724226015059330521307745219880895380984720100185192962436132310022795276696775543372465177293595510824165434504023089456506685903611257094891217268188479810011413207091589810199237311350431460985917754451961177135960165031052903561484607587322258513705287840897856781288293503342850508495209699080882724817735706957623211969144090159621393240709894133816120759058643089325172689623945455400166598924945164508554568288822435875963622759947037387256228901572557005075470572493958709597354373829157606430804110446437387981349290847681098358847781750191106667881993476866806700256467578454062665443806776482731043849915556699404872437050837967230814045665005956201216608246276676864206035148828852703831776863355116465292885628623080842414765406127863967302258310251940043865735771083254111299649899424518120410955481474322048153033680113423457288615073793538865287591953553045230504908928508984585539334123940249266698599374133805328039730101999836491540394441196034509253158626455510543970160290899558261884942113565395089376160050274064704097823828350118889727711356058801578652318532721596380964402103745175424283733202593364591531384853851203199649039686120316762621677946739379474284766010153405866975241318285784338547325067377949544536257802100574467612342125943913333215327182419536454733436597600428907024967609035719581697192988090874191568070096347437340045556463039400642762579937646490242299572598078149822768839074643734761056010191729173027512155625302761127067462329146185431037254680005521791860144807329527316187565313600609407922149170972042739276140489701217714025562468011356367444808887412746803981053880088429359725284215395823946804586256335129237381603659110769091448577417836559514688301972700996520924178908864922493081830494885924354106873182987322348586915276073443422147485772109227325995362650871612918008083899424406994887591627188026553144628921068894248698810125296639254854726332507057970731263809213013388234665840541158265989079025258231981407754706935110367101841129472039220322358047437960407522036162431726511376072066510913251770772351451926791423903200400226981381181694835519832087494431603666713424265532028976696365632442238537259770073658719478647263399923272627371770796436153034759246848261596723763064858456969392721609868033453435902922073191447185937301761116397779935963243265393580842717667919333701494439887884560958569488783628040273452461427265190690114651908805891691208647317880837079594924031603314745484558402459533779478457148322788191745549169767672996243924111972003147415682284674709844119531391842684813277709695171584556166245027927650571603761774004636539898054892384647294800196692061748262521945039726246288666646337726842613045483072952060354937748002998695612651135799608846840970178950983383948987481717642248909825115412021633464857889423319063647122308654164946761508913909455639259129122047585028278014244551920302673587869488469415958940476003013664144042677663790269189802646413916969622808273599152715065536215708281119462266211782908675664164467953134836291070344621856239042254378237423082431466175268601082280690902847692836809225043138923184265912113069129673687478920533341517946730874062734845213197856184998041964493476533039823788894154647612821575517660979394002550917385740388021254765224983948240941659373403232716900147374052412723359614608834140540399530087027638597238047859667900008741084134817871852306541987542302285051857813398175957883815200210326019854859110832766947447704616096768251583523199758210867038693794336245037172810278211414886705163868522071845756495213112788471373837404373564076705544056841977148640466189998430685031303291337551273064854802138802285828873196667987373151672366399498131049358581937187191490898474054304029686735689020516384349819146047951164008199730159350008994747474148665054452860524845146010699251872664525542039120604842832727105968856509788653448136891855074571910946754188963185599740646553523363833282142377057205164583479967375766872429702604129905504905745243375419737081469090403636633271585544633846871398145287522819556213625085839131024667068598743596673758884599712893693353904718097640187665602881310103950178782060149855172323651218393308891395059922326896799792791967655286581355939443781209645128649209349376764055591977771893726319617177747309044862055280623419613493655742885618249775287005018645620691329437640269291768158019336346748792418747046598628479681754386124756085163101898170053760090202294791562517754599321863175958908185372245614382520981291315307876164900274649520323646437192900150618301733864487566866899895590024426523405763288023467506358283697596440870277192920191168426834838141975899127369436000811343774594394600790602804504477089520077987566889158440279665234928439641297601487855163771359963872240840733985380313794651510530126408429899387566514017868903516768431853963363211454257258290945123106199432530705789307608775208179764642373697595370120132156979397252737375214674561677048085505407742254705795096659727111298420695999913098129166233080835812418132180620116233032897908556600131028045221065237550551022673908015565397984360067401433841295890927028606110859728380969070512410348270592535945563991726673831718582279959315110293747463094137961880570107792658964572561542273872823697036229339602260740947747057936092772251364145288869964824449718526352489895896112277831141294881399221912020645594692140601987635330163484012635315648114758382000951011374076045803421009539353392289273778521464181524427063513326917190091764306920216263544996421437288412804779337172583796147375760437848323661734971137725547166929358992862771439345418178202492246152290163910860107930391775643095931497339030424134607802172490430939438703518703240952444058852866122261839403036809881929107994925851204816429953113542997655111004810105089926187935180422061908459206771757196655245010225413092375847254242253079156423437072825206078451234996367172052045390867417534340622277710314639216734835700740533911642179124275218201989719746012836969656081295412674820670389223054089755748405184915501768747416320002583069797959842072184548648425063631613619919939319551545444788137976124548032534901
```

*solve.py*
```python
from Crypto.Util.number import *
from hashlib import md5
from Crypto.Util.Padding import *
from Crypto.Cipher import AES
from tqdm import tqdm

enc_flag = "e3c690b3918222d68f0871f51cabc0b2faeb5ee29b1ad53e440f07ab37e4c75d21e3db59ac35cae4672968b6fdd1c2bb"
enc_flag = bytes.fromhex(enc_flag)

key = 747655810723

flag = AES.new(
	key = md5(b"%d" % key).digest(),
	mode = AES.MODE_ECB
).decrypt(enc_flag)

print(unpad(flag, 16))
```
Flag: *uiuctf{Finding_Key_Via_Small_Subgroups}*